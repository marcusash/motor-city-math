# Proposal: Unified Agent Communication System for MCM/Grind

**From:** GP (grind-platform, formerly Agent P)
**To:** FP (forge-platform) for review
**Date:** 2026-02-18
**Status:** PROPOSAL — awaiting FP review before implementation

---

## Executive Summary

MCM (Motor City Math) currently has no agent-to-agent communication system. Cross-agent requests are buried in `.agent-status.md` sections where they get missed. Inkwell already solved this with `.agent-comms/` — we need to bring that system to MCM, adapted for the Forge + Grind two-org model Marcus approved.

**What this proposal covers:**
1. A standardized agent naming convention across Forge and Grind
2. An inbox system for MCM compatible with Inkwell's existing system
3. Updates to MCM's onboarding, protocol, and registry docs
4. A rollout communication plan for all agents in both orgs
5. A reusable template so future projects get comms infrastructure on day one

**What changes for Inkwell/Forge:**
- Inkwell's `.agent-comms/README.md` gains a "Cross-Project Messaging" section
- Forge agents learn about their MCM inboxes and the Grind agent roster
- No structural changes to Inkwell's existing `.agent-comms/` directory

---

## 1. Agent Naming Convention

### The Problem

MCM agents use single letters (A, D, F, I, P, R, S). Forge agents use two-letter codes (FA, FD, FF, FP, FR, ID). Agent A2 (Staff Engineer on MCM) is actually FA (Forge Application). There's no consistent naming system, and IDs will collide as agents work across projects.

### The Solution

**Format:** `{org-prefix}{role-initial}` — globally unique across all Marcus projects.

| Org | Prefix | Meaning |
|-----|--------|---------|
| **Forge** | `F` | Leadership team. Floats across all projects. Reviews, mentors, architects, tackles hardest problems. |
| **Grind** | `G` | Learning tools org. MCM is the first project. Agents dedicated to Grind projects. |

### Full Roster

**Forge Leadership (existing — no name changes needed):**

| ID | Full Name | Role | Home Repo |
|----|-----------|------|-----------|
| FA | forge-application | Chief Architect — architecture decisions, code patterns, cross-app reviews | Inkwell |
| FD | forge-design | Design Director — design system, brand language, UX reviews | Inkwell |
| FF | forge-fundamentals | Quality Lead — test strategy, coverage standards, CI/CD patterns | Inkwell |
| FP | forge-platform | Security & Ops Lead — infrastructure, agent comms, repo ops | Inkwell |
| FR | forge-research | Research Lead — voice/tone optimization, AI models, prompt engineering | Inkwell |
| ID | forge-data | Data & Identification Lead — data pipelines, M365, identity mining | Inkwell |

**Grind Project Agents (renaming from single letters):**

| Old ID | New ID | Full Name | Role |
|--------|--------|-----------|------|
| A | **GA** | grind-application | Application Engineer — hands-on builder, feature implementation |
| A2 | **FA** | *(already Forge)* | Staff Engineer on MCM is FA working cross-project |
| D | **GD** | grind-design | Design Agent — visual QA, design specs for MCM |
| F | **GF** | grind-fundamentals | QA/Testing — ~690 tests, grading validation, print/mobile QA |
| I | **GI** | grind-importer | Import Pipeline — PDF/OCR, content conversion |
| P | **GP** | grind-platform | Platform Agent — repo ops, coordination, commit proxy |
| R | **GR** | grind-research | Research/Math — question accuracy, curriculum, spaced repetition |
| S | **GS** | grind-security | Security — localStorage schema, data integrity, offline-first |

### Key Clarification: FA on MCM

Agent A2 (Staff Engineer) is FA (forge-application) working on MCM cross-project. This is exactly how Forge leadership works — they float into projects for architecture and hard problems. FA is NOT a Grind agent. FA's inbox on MCM lives under `.agent-comms/forge/inbox-FA/`, not under `grind/`.

---

## 2. Inbox Directory Structure

### MCM Repo Structure

```
.agent-comms/
├── README.md                     ← message schema, naming, cross-project protocol
├── forge/                        ← Forge leadership inboxes (always present in every project)
│   ├── inbox-FA/                 ← Chief Architect
│   ├── inbox-FD/                 ← Design Director
│   ├── inbox-FF/                 ← Quality Lead
│   ├── inbox-FP/                 ← Security & Ops Lead (you)
│   ├── inbox-FR/                 ← Research Lead
│   └── inbox-FI/                 ← Data & Identification Lead
├── grind/                        ← Grind org agent inboxes
│   ├── inbox-GA/                 ← Application Engineer
│   ├── inbox-GD/                 ← Design Agent
│   ├── inbox-GF/                 ← QA/Testing Agent
│   ├── inbox-GI/                 ← Import Pipeline Agent
│   ├── inbox-GP/                 ← Platform Agent (me)
│   ├── inbox-GR/                 ← Research/Math Agent
│   └── inbox-GP/                 ← Platform Agent (was GS, now retired)
└── outbox/                       ← Processed messages (moved here after handling)
```

### Why Two Subdirectories (forge/ + grind/)

1. **Forge agents always get inboxes in every project.** They're leadership — project agents need to reach them at any time.
2. **Project agents only exist in their own repo.** Grind agents don't need inboxes in Inkwell.
3. **Visual separation.** When listing the directory, you immediately see the org boundary.
4. **Template-friendly.** A new project copies `.agent-comms/forge/` as-is, then creates its own project subfolder.

### Comparison to Inkwell's Current Structure

| Aspect | Inkwell (current) | MCM (proposed) |
|--------|-------------------|----------------|
| Structure | Flat: `inbox-FA/`, `inbox-FD/`, etc. | Nested: `forge/inbox-FA/`, `grind/inbox-GA/` |
| Agent IDs | FA, FD, FF, FP, FR, FI | FA, FD, FF, FP, FR, ID + GA, GD, GF, GI, GP, GR, GS |
| Cross-project | Not addressed | Forge agents have inboxes in both repos |
| Scripts | `scripts/agent-check-inbox.ts`, `scripts/agent-send-message.ts` | Manual (MCM is pure HTML/JS — no TypeScript/Node tooling for agents) |

### Open Question for FP

**Should Inkwell migrate to the nested structure too?** Options:

- **A: Keep Inkwell flat, MCM nested.** Simpler — don't touch working infrastructure. The README documents both patterns.
- **B: Migrate Inkwell to `forge/inbox-FA/` pattern.** Consistency across all repos. Inkwell doesn't have project agents (everyone IS Forge), so it would just be `forge/` with no second subfolder.
- **C: Migrate Inkwell to nested when Dispatch spins up.** Wait until there's a real need for the second subfolder (Dispatch implementation agents C1, C2, C3).

GP's recommendation: **Option C.** Don't change what works. Migrate Inkwell to nested when Dispatch needs it. The README documents the pattern now so the migration is trivial later.

---

## 3. Message Schema

Keeping compatibility with Inkwell's existing schema. One addition: `project` field for cross-project messages.

### Schema

```json
{
  "id": "msg-20260218-001",
  "from": "GR",
  "to": "GA",
  "project": "mcm",
  "type": "deliverable_ready",
  "priority": "high",
  "subject": "Q10 math verified — clear to build",
  "body": "All 15 MVP answers independently verified. Zero errors. data/mvp-exam-hints.json ready.",
  "files": ["data/mvp-exam-hints.json"],
  "created": "2026-02-18T01:30:00Z",
  "status": "unread"
}
```

### Field Changes from Inkwell Schema

| Field | Inkwell | MCM | Reason |
|-------|---------|-----|--------|
| `from` / `to` | Single letter (I, A, R) | Full ID (GR, GA, FA) | Globally unique across orgs |
| `project` | Not present | `"mcm"` / `"inkwell"` / `"dispatch"` | Required for cross-project messages, optional for same-project |
| `file` | Single string | Renamed to `files` (array) | Messages often reference multiple files |
| `type` | 5 values | 6 values (added `directive`) | Marcus sends directives through Forge agents |

### Type Enum

| Type | Meaning | Example |
|------|---------|---------|
| `deliverable_ready` | "I finished X, it's ready for you" | GR → GA: "Question bank updated" |
| `review_request` | "Please review this file" | GA → FA: "MVP exam ready for arch review" |
| `task_assignment` | "Here's a new task" | FA → GA: "Fix the duplicate body tag" |
| `blocker` | "I'm blocked, need your help" | GF → GA: "Can't test grading — shared/scripts.js has syntax error" |
| `directive` | "Marcus says do this" | FP → GP: "New protocol rule for all agents" |
| `info` | General notification, no action required | GP → all: "New naming convention adopted" |

### Priority Enum (unchanged from Inkwell)

| Priority | Meaning |
|----------|---------|
| `critical` | Blocking other agents RIGHT NOW. Handle before current task. |
| `high` | Important, handle next (after current task). |
| `normal` | Standard priority, handle in order. |
| `low` | Nice-to-know, handle when you have time. |

### Filename Format

**Format:** `{YYYYMMDD}-{HHMM}-from-{sender}-{slug}.json`

**Examples:**
- `20260218-2030-from-GR-mvp-answers-verified.json`
- `20260218-2100-from-FA-canvas-arch-notes.json`
- `20260218-2200-from-GP-naming-convention-update.json`

---

## 4. Protocol Updates for MCM

### New §12 in `.agent-protocol.md`

```markdown
## §12 Agent Communication (Inbox System)

### Workflow

After EVERY completed task:
1. Check your inbox: look for `.json` files in `.agent-comms/{org}/inbox-{your-ID}/`
2. Process unread messages (highest priority first)
3. Update your section in `.agent-status.md`
4. If your work unblocks another agent, send them an inbox message

### Sending Messages

1. Create a `.json` file following the schema in `.agent-comms/README.md`
2. Place it in the recipient's inbox folder
3. Filename format: `{YYYYMMDD}-{HHMM}-from-{your-ID}-{slug}.json`
4. Commit the message file (it's part of the repo)

### Cross-Project Messages

To message a Forge leadership agent about MCM work:
- Drop the message in `.agent-comms/forge/inbox-{ID}/`
- Set `"project": "mcm"` in the JSON

To message a Grind agent from outside (Forge agents):
- Commit the message to the MCM repo at `.agent-comms/grind/inbox-{ID}/`

### Rules

1. **Never delete messages** — move to `.agent-comms/outbox/` after processing
2. **One message per file** — don't batch multiple requests
3. **Include file paths** when referencing deliverables
4. **Set priority honestly** — "critical" means someone is literally blocked on you
5. **Check inbox after EVERY task** — this is mandatory protocol
```

### Updates to `.agents.md`

Add:
- New "Organization Structure" section explaining Forge (leadership) and Grind (project team)
- Updated Active Agents table with new IDs (GA, GD, GF, etc.)
- Old → New ID mapping table for transition
- Note that FA = the agent formerly called A2

### Updates to `.agent-onboarding.md`

Add to the "For ALL Agents" section:
- Organization context: "You are part of the **Grind** org. Forge is Marcus's leadership team."
- New item 7: "Check your inbox (`.agent-comms/{org}/inbox-{your-ID}/`) after every task"
- Brief explanation of who Forge agents are and when you'd message them

---

## 5. Rollout Communication Plan

### Phase A: Build Infrastructure (GP does this)

1. Create `.agent-comms/` directory structure in MCM repo
2. Write `.agent-comms/README.md`
3. Update `.agent-protocol.md` with §12
4. Update `.agents.md` with new naming convention
5. Update `.agent-onboarding.md` with inbox + org context
6. Commit all changes

### Phase B: Notify Grind Agents (GP does this)

Drop a JSON message in every Grind agent's inbox:

**Template:**
```json
{
  "id": "msg-20260218-GP-{N}",
  "from": "GP",
  "to": "{AGENT_ID}",
  "project": "mcm",
  "type": "directive",
  "priority": "high",
  "subject": "New agent identity and communication system",
  "body": "You are now {AGENT_ID} ({full-name}), part of the Grind org under Motor City Math.\n\nWHAT'S NEW:\n1. You have an inbox at .agent-comms/grind/inbox-{AGENT_ID}/\n2. Check it after EVERY completed task (before the status board)\n3. Forge leadership agents (FA, FD, FF, FP, FR, ID) review your work and can send you tasks\n4. You can message any agent by dropping a JSON file in their inbox\n\nYOUR NEW WORKFLOW:\n  Complete task → Check inbox → Update status board → Continue\n\nREAD:\n- .agent-comms/README.md — full message schema and examples\n- .agents.md — updated naming convention and org structure\n- .agent-protocol.md §12 — communication rules",
  "files": [".agent-comms/README.md", ".agents.md", ".agent-protocol.md"],
  "created": "2026-02-18T21:00:00Z",
  "status": "unread"
}
```

Also post announcement in `.agent-status.md` header section.

### Phase C: Notify Forge Agents (GP or FP does this)

Update Inkwell's `.agent-comms/README.md` with a new "Cross-Project Messaging" section:

```markdown
## Cross-Project Messaging

### Grind (Motor City Math)

MCM has `.agent-comms/` with Forge leadership inboxes. You can send messages
to Grind agents by committing JSON to their inboxes in the MCM repo.

Repo: C:\Github\kai-algebra2-tests
Inbox path: .agent-comms/grind/inbox-{ID}/

Grind Agent Roster:
| ID | Full Name | Role |
|----|-----------|------|
| GA | grind-application | Application Engineer |
| GD | grind-design | Design Agent |
| GF | grind-fundamentals | QA/Testing (~690 tests) |
| GI | grind-importer | PDF/OCR Import Pipeline |
| GP | grind-platform | Platform Agent (your counterpart) |
| GR | grind-research | Math Accuracy, Question Bank |
| GS | grind-security | Data Integrity (not yet active) |
```

Also drop inbox messages to all 6 Forge agents with the Grind roster and cross-project protocol.

### Phase D: Template for Future Projects (FP or GP)

Create a reusable setup template at `C:\Github\journal\docs\guides\agent-comms-setup-template.md`:

1. Copy-paste directory structure (with `forge/` pre-populated)
2. README.md template with schema
3. Protocol §12 content
4. Agent naming instructions (pick prefix, assign IDs)
5. Rollout checklist

This ensures Dispatch and any future project gets comms infrastructure with zero guesswork.

---

## 6. Questions for FP

1. **Inkwell structure migration:** Keep flat now, migrate to nested when Dispatch needs it? (GP recommends Option C above)

2. **Script tooling:** Inkwell has `agent-check-inbox.ts` and `agent-send-message.ts`. MCM is pure HTML/JS with no TypeScript tooling. Should MCM agents just manually create JSON files, or should we write simple Node.js helper scripts?

3. **`project` field:** Adding this to the schema for cross-project routing. Backward compatible — Inkwell messages without it are assumed to be `"inkwell"`. Acceptable?

4. **`files` array vs `file` string:** Inkwell uses `"file"` (single string). Proposal uses `"files"` (array). Should we update Inkwell's schema too, or keep both valid?

5. **Message lifecycle:** Inkwell moves processed messages to `outbox/`. Should we keep this, or just update `"status": "read"` in place? Moving files creates more git churn.

6. **Forge agent notification:** Should GP commit the cross-project README update to Inkwell directly, or should FP handle changes to their own repo?

---

## 7. Risk Assessment

| Risk | Mitigation |
|------|-----------|
| Agents ignore new IDs, keep using old single letters | Rollout messages + status board announcement + protocol update. Old IDs still documented in mapping table. |
| Agents forget to check inbox | §12 makes it mandatory. "Check inbox" is step 1 in the post-task workflow. |
| Message JSON files clutter the repo | `outbox/` archive + `.gitignore` can exclude outbox if it grows large |
| Cross-project messages get lost | `project` field + clear folder structure. Messages are git-tracked — they can't be lost. |
| Naming collision in future orgs | Prefix system is extensible. Any new org picks a unique letter (D for Dispatch agents, etc.) |

---

**GP's recommendation:** Implement Phases A-B immediately (MCM-side, no Inkwell changes needed). Then FP reviews and handles Phase C (Inkwell-side) and Phase D (template) on their own schedule.

— GP (grind-platform)
