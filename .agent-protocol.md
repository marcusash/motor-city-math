# Motor City Math â€” Agent Protocol

> Communication rules for multi-agent collaboration on this project.
> Every agent reads this file on startup. Violations create merge conflicts and wasted work.

---

## 1. Agents

| ID | Name | Primary Responsibility |
|----|------|----------------------|
| A | Application Agent | Build system, shared components, test templates, dashboard, grading engine |
| R | Research Agent | Question bank, math accuracy, curriculum alignment, pedagogy, spaced repetition |
| D | Design Agent | Visual design, CSS, responsive, accessibility, print layout, interaction specs |
| F | Fundamentals Agent | Testing, answer validation, grading accuracy, edge cases, print QA, regression |
| S | Security Agent | Data integrity, localStorage schema, save/load, offline-first, progress tracking |
| P | Platform Agent | Agent coordination, repo structure, CI/CD, docs, taskboards, README |

---

## 2. Shared Files

| File | Maintainer | Purpose |
|------|-----------|---------|
| `.agents.md` | P | Agent registry, file ownership, rules |
| `.agent-status.md` | Each agent (own section) | Live task tracking, blockers, deliverables |
| `.agent-protocol.md` | P | This file â€” communication rules |
| `.marcus-queue.md` | All agents (write), Marcus (read) | Items needing Marcus's input or decision |
| `.design-system.md` | D | Visual specs, color palette, components, layout |
| `.voice-guide.md` | D | Copy/tone guidelines, ADHD-aware feedback, Pistons voice |
| `.project-review.md` | D | Project inventory, architecture, opportunities |
| `README.md` | P | Public-facing project description |

---

## 3. Status Board Format

Every agent maintains their section in `.agent-status.md` using this format:

```markdown
## {Agent Name} Status
_{Scope description}_

> **Executive Summary:** {1-2 sentence status}

- [x] TASK-ID: Description â€” DONE âœ… {details}
- [ ] TASK-ID: Description â€” {status}
- [ ] TASK-ID: Description â€” BLOCKED on {what}

### Findings
- {severity emoji} {finding description}

### Cross-Agent Requests
- For Agent {X}: {specific request}
```

Task IDs use format: `{agent-letter}-{number}` (e.g., A-1, R-3, F-7)

---

## 4. File Ownership Rules

- **Read any file.** All files are readable by all agents.
- **Write only owned files.** Check `.agents.md` â†’ File Ownership table.
- **Request changes to others' files** via `.agent-status.md` â†’ Cross-Agent Requests.
- **Shared files** (`.agent-status.md`, `.marcus-queue.md`) â€” write only your section.
- **New files**: Claim ownership by adding to `.agents.md` before creating.

---

## 5. Communication Channels

### Agent â†’ Agent
Post in `.agent-status.md` under "Cross-Agent Requests" with:
```
For Agent {X}: {specific request}
Context: {why you need it}
Blocking: {what it blocks, or "non-blocking"}
```

### Agent â†’ Marcus
Post in `.marcus-queue.md` with severity:
- ðŸ”´ **BLOCKER** â€” Cannot proceed without Marcus's input
- ðŸŸ¡ **DECISION** â€” Need a choice between options
- ðŸŸ¢ **FYI** â€” Informational, no action needed

### Marcus â†’ Agents
Marcus writes in `.marcus-queue.md` or directly in `.agent-status.md` under the relevant agent's section.

---

## 6. Delivery Protocol

### Delivering Content (questions, data)
- Format: JSON with schema documented in a companion `.schema.md` file
- Filename prefix: `.` for agent-generated files (e.g., `.question-bank-draft.json`)
- After delivery: Post "DONE âœ…" in status board with file path

### Delivering Code (HTML, CSS, JS)
- Must work in browser (no build step required for v1)
- Must pass: (a) opens without console errors, (b) print layout works, (c) auto-grading gives correct results
- After delivery: Post commit hash + what changed in status board

### Delivering Specs (design, architecture)
- Format: Markdown with `.` prefix (e.g., `.dashboard-spec.md`)
- Include: wireframe (ASCII), behavior description, edge cases
- After delivery: Tag receiving agent in Cross-Agent Requests

---

## 7. Bug Reports

File bugs in `.agent-status.md` â†’ Bugs section:

```markdown
### Bugs

| ID | Severity | Description | File | Owner | Status |
|----|----------|-------------|------|-------|--------|
| B-1 | high | Grading accepts "x=3" but not "3" | index.html | A | open |
```

Severity levels:
- `blocker` â€” Cannot ship. Data loss or math error.
- `high` â€” Wrong answer accepted/rejected, broken grading.
- `medium` â€” UX issue, layout broken on a device.
- `low` â€” Cosmetic, typo, minor polish.

**Math errors are always `blocker` severity.** A wrong answer in an answer key means a student learns the wrong thing.

---

## 8. Quality Gates

Before marking any task DONE:

1. **Opens in browser** â€” No console errors, no 404s for CDN resources
2. **Grading works** â€” If the file has auto-grading, submit correct answers and verify score
3. **Print works** â€” `Ctrl+P` shows clean layout, no buttons, page breaks work
4. **Math renders** â€” All equations display correctly (KaTeX or plain text)
5. **Mobile works** â€” Resize browser to 375px width, verify nothing is cut off
6. **Answers are correct** â€” Research agent has verified every answer in the answer key

---

## 9. Execution Order

### Phase 1: Foundation
1. **P** sets up agent infrastructure (this file, status board, protocol)
2. **D** finalizes design system (`.design-system.md` already done)
3. **R** audits all 200 existing questions for accuracy
4. **A** extracts shared CSS/JS from existing 12 files

### Phase 2: Core Features
5. **A** builds auto-grading engine (shared `scripts.js`)
6. **R** builds question bank JSON (`data/questions.json`)
7. **A** creates test template that consumes JSON + shared CSS/JS
8. **D** specs dashboard layout
9. **F** writes grading validation tests

### Phase 3: Product
10. **A** builds dashboard (`index.html`)
11. **A** implements per-standard scoring
12. **R** adds difficulty ratings + spaced repetition logic
13. **S** builds progress tracking (localStorage schema)
14. **D** implements responsive + dark mode

### Phase 4: Scale
15. **R** + **A** build randomized practice mode
16. **R** adds hint system + step-by-step solutions
17. **A** builds test builder (custom test from question bank)
18. **F** regression tests on all existing tests

---

## 10. Project-Specific Rules

1. **No build tools in v1.** The project works by opening HTML files in a browser. Keep it that way. A build system can come in v2 if needed.
2. **Offline-first.** CDN dependencies (KaTeX, Chart.js) must have local fallback or be bundled. Kai studies on the bus without WiFi.
3. **Math accuracy is a blocker.** Every question, answer, hint, and step-by-step solution must be mathematically verified by the Research agent before shipping.
4. **Print is a first-class feature.** Every test must produce a clean printable version. Teachers and students still use paper.
5. **Kai is 15 and has ADHD.** The voice is coach-like, not patronizing. Copy must be clear, short, and motivating â€” never wordy. See `.design-system.md` Â§14 and `.voice-guide.md` for copy guidelines.
6. **Standards-based.** All questions map to SAAS curriculum standards. This alignment is maintained by the Research agent.

---

*Adapted from the Inkwell agent protocol (6 agents, 18 rounds of bug fixes, 529 tests).*
