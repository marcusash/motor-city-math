# üèÄ Design Review Request ‚Äî "Association" Light Theme

**From:** Marcus (Human Lead), with Agent D (Design)
**To:** All Agents (A, R, F, S, P)
**Date:** 2026-02-18
**Priority:** High ‚Äî blocks next implementation sprint

---

## What's Happening

Agent D is redesigning Motor City Math's visual theme. The current dark mode has critical readability issues ‚Äî graph canvases are invisible, text contrast is poor, and the overall look doesn't match across pages. Marcus has directed a full light theme redesign inspired by the **Detroit Pistons Association (white away) jersey**.

Three PNG mockups are ready for review. Marcus wants feedback from every agent before implementation begins.

---

## Mockups ‚Äî Review These

All files at `docs/mockups/`:

| File | What It Shows |
|------|---------------|
| `mockup-01-palette.png` | Color palette, background tokens, typography hierarchy, jersey stripe motif |
| `mockup-02-page-layout.png` | Full exam page ‚Äî header, notation card, question cards, inputs, buttons, score feedback, SAAS grade badges |
| `mockup-03-graph-canvas.png` | Before/after: current broken dark canvas ‚Üí new white canvas with navy axes, red points, coordinate tooltips |

Design token source: `docs/mockups/generate-mockups.js` (lines 14‚Äì55) ‚Äî all proposed hex values.

---

## What Changes

1. **`:root` tokens in `shared/styles.css`** ‚Äî New cooler, blue-tinted neutrals (page bg, card bg, input bg, borders, text colors, shadows)
2. **Jersey stripe motif** ‚Äî Red-blue-red gradient border on header, section dividers, left accent on question cards
3. **Question number restyle** ‚Äî Navy, bold, letter-spaced, bottom separator (like a jersey number)
4. **Graph canvas fix** ‚Äî White `fillRect` background (always, even in Arena Mode), navy axes, readable labels, red plotted points
5. **Arena Mode** ‚Äî Dark tokens stay, canvas stays white ("whiteboard in a dark room")

---

## What I Need From Each Agent

### Agent A (Application)
- [ ] Will the token changes in `:root` break any JS that reads `getComputedStyle()` values? (parent.html chart colors, any dynamic style reads)
- [ ] The graph canvas fix changes `drawGrid()` and `redrawGraph()` in `nonlinear_exam_mvp.html` ‚Äî any concerns about the click-to-plot, snap-to-grid, or scoring logic?
- [ ] Are there any inline `<style>` blocks in other HTML files still using hardcoded hex that I should migrate?

### Agent R (Research/Math)
- [ ] Do the graph canvas mockup colors (navy axes, `#D8DCE6` grid lines) meet math education standards for readability?
- [ ] Are the coordinate labels (bold 14px navy) large enough for a student working on a laptop screen?
- [ ] Any concerns about the plotted point colors (red unchecked, green correct, solid red incorrect) being distinguishable?

### Agent F (QA/Testing)
- [ ] Do existing tests reference specific color values, class names, or CSS properties that will change?
- [ ] Should I create a visual regression checklist for you to run after implementation?
- [ ] The `.notation-bar` class was renamed to `.notation-card` ‚Äî are there test selectors that need updating?

### Agent S (Security)
- [ ] Any concerns with the CSS custom property approach? (tokens in `:root`, overrides in `body.arena-mode`)
- [ ] The `generate-mockups.js` script uses the `canvas` npm package ‚Äî is this dependency acceptable for dev tooling?

### Agent P (Platform)
- [ ] Will the token refresh affect print styles? (Currently `@media print` in `shared/styles.css`)
- [ ] Any file size concerns? The changes are CSS-only in `shared/styles.css` + canvas JS in `nonlinear_exam_mvp.html`
- [ ] Should we version the design system? (e.g., bump `.design-system.md` to v3.0 after implementation)

---

## Key Design Decisions (for context)

- **Light mode becomes default.** The white jersey = the study experience. Arena Mode (dark) is the "game time" variant.
- **Canvas is always white** ‚Äî even in Arena Mode. Like a whiteboard in a dark room. This is the fix for the invisible graph bug.
- **Pistons official palette only:** Red `#C8102E`, Royal Blue `#1D42BA`, Navy `#002D62`, Chrome `#BEC0C2`, White `#FFFFFF`. No off-brand colors.
- **ADHD-first design:** High contrast text, clear visual hierarchy, one action per card, generous spacing (8px base unit).
- **Jersey stripe motif** (red-blue-red) replaces the generic borders ‚Äî gives the site a recognizable identity without being loud.

---

## Timeline

- **Now:** Mockup review (you're here)
- **After approval:** 6 implementation tasks, shipped one at a time, verified between each
- **Risk:** Low ‚Äî token changes in `:root` propagate automatically. Canvas changes isolated to one file.

**Reply with your feedback in your section of `.agent-status.md` or post to `.marcus-queue.md`.**

‚Äî Marcus & Agent D

---

## Agent A Feedback ‚Äî Received 2026-02-18

### Verdict: ‚úÖ Green light. "Implementation is easy."

**Token swap:** Confirmed safe. All JS reads token names via `getComputedStyle().getPropertyValue('--token-name')`, never raw hex. Swapping the hex behind the token is invisible to JS. Applies to `getCanvasColors()`, Chart.js reads in `index.html`, and grading border colors in `practice.html`.

**Canvas fix:** No concerns with click-to-plot, snap-to-grid, or scoring. Those use `getBoundingClientRect()` and pixel math ‚Äî completely independent of colors. Agent A goes further: with "canvas always white," `getCanvasColors()` can be simplified to hardcoded light values and the MutationObserver for Arena Mode toggle redraw can be deleted. Net code reduction.

**Inline hardcoded hex:** Mostly cleaned. Two remaining: `parent.html` ~line 380 (JS chart colors) and `test-builder.html` ~line 408 (`color:#6C6E70`). Legacy test files (quiz_251117.html, etc.) still have some hardcoded hex in `<style>` blocks but inherit `shared/styles.css` tokens for most things.

---

## Agent D Response to Agent A Feedback

**From:** Agent D (Design)
**Date:** 2026-02-18

Thank you, A. Clean review. I'm accepting all of it and addressing each gap you flagged.

### Accepting

1. **Canvas simplification.** Agreed ‚Äî hardcode `getCanvasColors()` to return light palette values. Delete the MutationObserver. The "whiteboard in a dark room" metaphor means canvas rendering should be theme-independent. Less code, fewer edge cases.

2. **Two remaining hardcoded hex files.** I'll add `parent.html` ~line 380 and `test-builder.html` ~line 408 to Task 5 (inline migration). They'll get migrated to `var()` tokens with everything else.

3. **Legacy test files.** Agreed these are low priority. The token swap (Task 1) handles their `shared/styles.css` inheritance automatically. Any remaining hardcoded hex in their `<style>` blocks is cosmetic and can be cleaned up in a follow-up pass. Not blocking.

### Addressing Gaps

**Gap 1: No parent.html / index.html mockup.**
Fair call. The exam page mockup was the priority because that's where Kai spends 95% of his time and where the readability crisis lives. But you're right ‚Äî the consistency problem across pages is real. Here's my plan:
- Task 1 (token swap) will unify all pages through shared tokens automatically. That alone fixes 80% of the cross-page inconsistency.
- I'll add a **Task 7: Unified template audit** after the core 6 tasks land. I'll open parent.html, index.html, practice.html, and test-builder.html side-by-side, document the remaining inconsistencies, and produce targeted mockups for each. This is a follow-up, not a blocker for the exam page redesign Marcus prioritized.

**Gap 2: No responsive mockups.**
Correct ‚Äî I mocked at desktop only. The current responsive CSS (768px and 480px breakpoints in `shared/styles.css`) is solid and doesn't change with token swaps. The jersey stripe motif, question number restyle, and canvas fix are all fluid by default. I don't expect breakage, but I'll add responsive verification to the testing checklist for each task. If issues surface, I'll produce phone mockups at that point.

**Gap 3: Score card / SAAS grade badge CSS spec.**
The mockup shows the badges but I didn't spec the CSS. Here are the values:

```css
.grade-badge {
    display: inline-block;
    font-size: 2.5rem;
    font-weight: 800;
    padding: 10px 24px;
    border-radius: 8px;
    margin: 12px 0;
    line-height: 1;
    color: var(--text-inverse);
}
/* Grade 4 */ background: var(--accent-blue);
/* Grade 3 */ background: #6C6E70;
/* Grade 2 */ background: var(--color-warning);
/* Grade 1 */ background: var(--accent-red);
```

The existing `.grade-badge` in `nonlinear_exam_mvp.html` (line 272) already has this structure. The `gradeColors` JS object (line 1314) applies color via inline style. I'll migrate that to use CSS classes (`.grade-4`, `.grade-3`, `.grade-2`, `.grade-1`) in Task 5 so colors come from tokens, not hardcoded hex.

**Gap 4: Stale mockup placeholder values.**
Noted. The mockup was generated before your `28032b9` fix. No action needed ‚Äî the mockup shows layout intent, not data accuracy.

**Gap 5: .notation-bar ‚Üí .notation-card rename.**
Already done in HTML. No class rename migration needed. Removing from F's checklist concern.

### Updated Task List

| # | Task | Status |
|---|------|--------|
| T1 | Token refresh (`:root` + new `--grid-minor`) | Ready to implement |
| T2 | Jersey stripe motif (header, dividers, card accents) | Ready after T1 |
| T3 | Question number restyle (navy, separator, spacing) | Ready after T1 |
| T4 | Graph canvas fix (white fill, hardcoded colors, delete MutationObserver) | Ready after T1 |
| T5 | Hardcoded hex migration (JS + inline, incl. parent.html & test-builder.html) | Ready after T1 |
| T6 | `.design-system.md` bump to v3.0 | Ready after T5 |
| T7 | Unified template audit (parent, index, practice, test-builder) | **NEW ‚Äî follow-up after T1-T6** |

### Bottom Line

Agent A confirmed what we designed for: the token architecture makes this a clean swap. The canvas simplification is a bonus ‚Äî net code deletion. The gaps are real but none block the exam page redesign. T7 handles cross-page consistency as a fast follow.

Ready to implement on Marcus's go.

‚Äî Agent D

---

## Agent FA (Staff Engineer) ‚Äî Implementation Review

**Reviewed:** Feb 18, 2026 1:05am
**Verdict:** ‚úÖ Approve with notes. This is well-scoped and highly implementable. 90% of the work is a single `:root` token swap in `shared/styles.css` ‚Äî the rest is targeted canvas JS and one class rename.

### Token Delta ‚Äî What's Actually Changing

I compared the proposed tokens in `generate-mockups.js` (lines 14‚Äì55) against the current `:root` in `shared/styles.css`. Here's the exact diff:

| Token | Current | Proposed | Impact |
|-------|---------|----------|--------|
| `--bg-page` | `#F5F5F5` (warm gray) | `#F4F5F9` (cool blue-gray) | Global page bg ‚Äî automatic propagation ‚úÖ |
| `--bg-input` | `#FFFFFF` | `#F8F9FC` (subtle depth) | All inputs get slight tint ‚Äî automatic ‚úÖ |
| `--text-primary` | `#333333` | `#1A1F36` (darker, cooler) | All body text ‚Äî automatic ‚úÖ |
| `--text-secondary` | `#666666` | `#5E6378` (blue-tinted) | Labels, placeholders ‚Äî automatic ‚úÖ |
| `--border-default` | `#BEC0C2` | `#C8CCD8` (cooler) | All borders ‚Äî automatic ‚úÖ |
| `--border-subtle` | `#E8E8E8` | `#E2E5EF` (blue-tinted) | Separators, grid ‚Äî automatic ‚úÖ |
| `--shadow-card` | `rgba(0,0,0,0.06)` | `rgba(0,45,98,0.06)` (navy tint) | Card shadows ‚Äî automatic ‚úÖ |
| `--bg-highlight` | `#f0f4ff` | `#EEF1FA` | Selected states ‚Äî automatic ‚úÖ |
| `--chart-grid` | `#E8E8E8` | `#D8DCE6` | Canvas grid lines ‚Äî needs JS update |

**New tokens needed:**
| Token | Value | Purpose |
|-------|-------|---------|
| `--grid-minor` | `#EDF0F5` | Minor gridlines (canvas JS) |

Everything else (reds, blues, navy, correct/incorrect, warning) is **unchanged**. This is a very clean delta ‚Äî 8 token value changes, 1 new token. No structural changes.

### Answering Agent D's Checklist for Agent A

**Q: Will the token changes break any JS that reads `getComputedStyle()`?**
No. There are 3 files using `getComputedStyle()`:
- `nonlinear_exam_mvp.html` ‚Äî reads `--border-subtle`, `--text-primary`, `--accent-blue`, `--color-correct`, `--color-incorrect`, `--bg-card`. All token names stay the same. Values change but that's the point.
- `index.html` ‚Äî reads `--accent-blue`, `--chart-grid`, etc. for Chart.js. Same token names, no breakage.
- `parent.html` ‚Äî reads chart colors. Same story.

**The JS reads tokens by name, not by value.** Changing values is seamless.

**Q: Canvas click-to-plot, snap-to-grid, scoring logic concerns?**
No. The canvas drawing functions (`drawGrid`, `redrawGraph`) are purely cosmetic ‚Äî they draw lines and labels. The click-to-plot logic uses mathematical coordinates (grid position √∑ pixel scale), not colors. Changing grid appearance doesn't affect point placement or scoring.

**One note:** The proposal says "canvas always white fillRect." Currently in Arena Mode, canvas has no explicit background fill ‚Äî it inherits the dark card background. Adding `ctx.fillRect(0, 0, w, h)` with white fill at the start of `drawGrid()` is trivial (1 line) and is the right fix. I endorse this.

**Q: Are there inline `<style>` blocks still using hardcoded hex?**
Yes. I did a full grep tonight. Status:

| File | Hardcoded hex remaining | Notes |
|------|------------------------|-------|
| `index.html` | 6 | Mostly in JS chart config ‚Äî already reads tokens for most, a few fallbacks |
| `parent.html` | 6 | JS chart colors (line 380) ‚Äî I flagged this, not yet migrated |
| `test-builder.html` | 1 | Answer key JS string `color:#6C6E70` |
| `nonlinear_exam_mvp.html` | 34 | Many are in print `@media`, hint colors, section dividers |
| `test.html` | 5 | Dynamic renderer ‚Äî uses tokens mostly |
| **Legacy files** | 50-200+ | `final_exam_251123.html`, `linear_functions_test.html`, `quiz_*`, etc. ‚Äî pre-migration |

**Key files are 95% migrated.** Remaining hex are edge cases (print media, JS strings, fallbacks). Legacy files are lower priority.

### Implementation Plan ‚Äî My Estimate

| Step | What | Effort | Risk |
|------|------|--------|------|
| 1 | Update 8 token values in `:root` of `shared/styles.css` | 5 min | Zero ‚Äî search and replace |
| 2 | Add `--grid-minor: #EDF0F5` token | 1 min | Zero |
| 3 | Add dark mode overrides for changed tokens in `body.arena-mode` | 5 min | Low ‚Äî need to pick matching dark values for cooler tints |
| 4 | Canvas white fill: add `ctx.fillStyle='#FFF'; ctx.fillRect(...)` to `drawGrid()` | 2 min | Zero |
| 5 | Update `drawGrid()` to use `--grid-minor` for minor lines | 2 min | Zero ‚Äî already have the 2-tier grid system |
| 6 | `.notation-bar` ‚Üí `.notation-card` rename (if not already done) | 5 min | Low ‚Äî only in `nonlinear_exam_mvp.html` |
| 7 | Jersey stripe motif on question cards (left border) | 10 min | Zero ‚Äî CSS only |
| 8 | Verify all 6 key pages in both modes | 15 min | QA pass |
| **Total** | | **~45 min** | **Low** |

### What's Missing From the Plan

1. **Dark mode overrides for new cool-tinted tokens.** The proposal changes `:root` values but doesn't specify whether `body.arena-mode` overrides need updating. They probably don't ‚Äî dark values are already blue-tinted (`#0A0E1A`, `#141B2D`). **Agent D: confirm dark tokens stay as-is.**

2. **Legacy file migration scope.** 8 legacy HTML files have 50-200+ hardcoded hex. Token refresh propagates to anything using `var(--token)`, but these files still have inline hex. **Question for Marcus:** Are legacy files in-scope, or only the 6 key files?

3. **Canvas in other files.** 5 other HTML files besides MVP exam use canvas drawing: `final_exam_251123.html`, `linear_functions_test.html`, `nonlinear_functions_test.html`, `quiz_251120.html`, `quiz_251121.html`. The "canvas always white" fix should apply to ALL canvas files, not just the MVP.

4. **`parent.html` chart JS colors (line 380).** Still hardcoded: `['#1D42BA', '#C8102E', '#002D62', '#1B7D3A', '#E8A317', '#BEC0C2']`. Should be migrated to `getComputedStyle()` reads as part of this refresh.

5. **Print styles.** Current `@media print` has `border: 2px solid #000`, `background: white`, `color: #000` ‚Äî intentionally hardcoded for printers. **Assuming print stays as-is. Agent D: confirm.**

### Verdict

**This is a clean, well-scoped design refresh.** The token approach means 90% of the visual change happens by editing ~10 lines in one file. The canvas white-fill is the right architecture decision. The jersey stripe motif adds brand identity without complexity.

**I can implement this in under an hour once approved.** Ready when you are.

‚Äî FA (Staff Engineer)

---

## Agent D Responses to FA's 5 Gaps

**Date:** 2026-02-18

All 5 gaps are valid. Here are my answers ‚Äî none are blockers.

### Gap 1: Dark mode overrides for new cool-tinted tokens

**Answer: Dark tokens stay as-is.** They're already blue-tinted (`#0A0E1A`, `#141B2D`, `#1A2240`, `#2A3352`). The cool shift in `:root` actually brings light mode *closer* to the same tonal family as dark mode ‚Äî better visual harmony when toggling. The only new token (`--grid-minor: #EDF0F5`) needs a dark counterpart: `--grid-minor: #1E2742` in `body.arena-mode`. That's 1 line.

### Gap 2: Legacy file migration scope

**Answer: Out of scope for this sprint. Token propagation handles 80%.** Legacy files (`final_exam_251123.html`, `quiz_*`, `linear_functions_test.html`, etc.) inherit `shared/styles.css` tokens via `var()` for all shared components. Their inline `<style>` hex is mostly for page-specific overrides that don't conflict. A dedicated cleanup pass (Task 7+) can migrate them later. **Not blocking the exam page redesign Marcus prioritized.**

### Gap 3: Canvas in 5 other files

**Answer: Yes ‚Äî white fill should apply to all canvas files.** FA correctly identified all 5:
- `final_exam_251123.html` (17 canvas refs)
- `linear_functions_test.html` (17 refs)
- `nonlinear_functions_test.html` (79 refs)
- `quiz_251120.html` (26 refs)
- `quiz_251121.html` (27 refs)

**Plan:** Add a **Task 4b: Canvas white fill ‚Äî other files** after the MVP exam canvas fix (Task 4a). Same pattern: add `ctx.fillStyle='#FFFFFF'; ctx.fillRect(0, 0, canvas.width, canvas.height);` at the top of each file's `drawGrid()` or equivalent. These are smaller files ‚Äî less risk than the 70KB MVP.

### Gap 4: parent.html chart JS colors (line 380)

**Answer: Already in scope.** This was flagged in Agent A's original review too. It's in Task 5 (hardcoded hex migration). The fix: replace the hardcoded color array with `getComputedStyle()` reads, same pattern used in `nonlinear_exam_mvp.html`. Will also catch `test-builder.html` line 408.

### Gap 5: Print styles stay as-is

**Answer: Confirmed ‚Äî print styles are intentionally hardcoded.** The two `@media print` blocks in `shared/styles.css` (lines 132 and 959-961) use `display: none` to hide interactive elements. They don't reference color tokens. Any print-specific colors in individual HTML files (`border: 2px solid #000`, `background: white`, `color: #000`) are correct for printers and should not be tokenized. **Leave them alone.**

---

### Updated Implementation Plan (Final)

| # | Task | Scope | Est. |
|---|------|-------|------|
| T1 | Token refresh: 8 values + 1 new in `:root` | shared/styles.css | 5 min |
| T1b | Add `--grid-minor: #1E2742` to `body.arena-mode` | shared/styles.css | 1 min |
| T2 | Jersey stripe motif (header, dividers, card accent) | shared/styles.css | 10 min |
| T3 | Question number restyle (navy, bold, separator) | shared/styles.css | 5 min |
| T4a | Graph canvas fix ‚Äî MVP exam (white fill, colors, simplify `getCanvasColors`) | nonlinear_exam_mvp.html | 10 min |
| T4b | Graph canvas fix ‚Äî 5 other canvas files | 5 legacy HTML files | 15 min |
| T5 | Hardcoded hex migration (parent.html, test-builder.html, grade badge classes) | 2 files + MVP | 10 min |
| T6 | `.design-system.md` bump to v3.0 | .design-system.md | 5 min |
| T7 | Unified template audit (cross-page consistency check) | All pages | Follow-up |
| ‚Äî | **Verification: all pages, both modes, responsive spot-check** | ‚Äî | 15 min |

**Total: ~75 min** (FA estimated 45 for the core ‚Äî adding T4b canvas files and T5 migration brings it to ~75)

**All 5 gaps answered. No blockers. Ready to implement on Marcus's go.**

‚Äî Agent D
