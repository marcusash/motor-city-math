<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Algebra 2 - Linear Functions Practice Test (Calculator)</title>
    <script src="shared/chart.min.js"></script>
    <script>if(typeof Chart==="undefined"){var s=document.createElement("script");s.src="https://cdn.jsdelivr.net/npm/chart.js";document.head.appendChild(s);}</script>
    <script src="shared/chart-theme.js"></script>
    <link rel="stylesheet" href="shared/styles.css">
    <link rel="stylesheet" href="shared/print.css">
    <style>
        /* File-specific: math input panel and calculator widget */
        .math-input-toggle {
            background: #1D42BA;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
            margin-top: 10px;
            transition: background 0.2s;
        }

        .math-input-toggle:hover {
            background: #153399;
        }

        .math-input-panel {
            background: #f0f4ff;
            border: 2px solid #1D42BA;
            border-radius: 4px;
            padding: 15px;
            margin-top: 10px;
            display: none;
        }

        .math-input-panel.show {
            display: block;
        }

        .math-display {
            background: white;
            border: 2px solid #BEC0C2;
            border-radius: 4px;
            padding: 12px;
            min-height: 45px;
            font-size: 1.3em;
            font-family: 'Times New Roman', serif;
            margin-bottom: 15px;
            text-align: left;
            display: flex;
            align-items: center;
        }

        .math-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .math-insert-btn {
            background: #1B7D3A;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
        }

        .math-clear-btn {
            background: #C8102E;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
        }

        .math-buttons {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
        }

        .math-btn {
            background: #1D42BA;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1.1em;
            transition: background 0.2s;
        }

        .math-btn:hover {
            background: #153399;
        }

        .math-btn.special {
            background: #002D62;
        }

        .math-btn.special:hover {
            background: #001D42;
        }

        .calc-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #C8102E;
        }

        .calc-title {
            font-weight: bold;
            color: #C8102E;
            font-size: 1.2em;
        }

        .calc-close {
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            color: #666;
            padding: 0;
        }

        .calc-display {
            width: 100%;
            padding: 15px;
            font-size: 1.3em;
            border: 2px solid #BEC0C2;
            border-radius: 4px;
            margin-bottom: 15px;
            text-align: right;
            font-family: 'Courier New', monospace;
            background: #f9fafb;
        }

        .calc-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }

        .calc-btn {
            padding: 15px;
            font-size: 1.1em;
            border: 2px solid #BEC0C2;
            border-radius: 4px;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
        }

        .calc-btn:hover {
            background: #1D42BA;
            color: white;
            border-color: #1D42BA;
        }

        .calc-btn.operator {
            background: #002D62;
            color: white;
            border-color: #002D62;
        }

        .calc-btn.operator:hover {
            background: #001D42;
        }

        .calc-btn.equals {
            background: #1B7D3A;
            color: white;
            border-color: #1B7D3A;
            grid-column: span 2;
        }

        .calc-btn.equals:hover {
            background: #156330;
        }

        .calc-btn.clear {
            background: #C8102E;
            color: white;
            border-color: #C8102E;
        }

        .calc-btn.clear:hover {
            background: #A00D24;
        }

        .calc-toggle-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #1D42BA;
            color: white;
            border: none;
            padding: 15px 20px;
            font-size: 1.5em;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(29, 66, 186, 0.4);
            transition: all 0.2s;
            z-index: 998;
        }

        .calc-toggle-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(29, 66, 186, 0.6);
        }

        @media print {
            .math-input-toggle, .math-input-panel, .calc-toggle-btn {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <a href="#main" class="sr-only">Skip to content</a>
    <div class="container" role="main" id="main">
        <div class="print-header">
            <strong>Algebra 2 Practice Test</strong><br>
            Name: _____________________ Date: ___________
        </div>
        <header data-time-minutes="35">
            <h1>üéì Algebra 2 Practice Test</h1>
            <div class="subtitle">Linear Functions - Standards 3 & 4</div>
            <div style="margin-top: 20px; padding: 15px; background: #f0f4ff; border-radius: 4px; border: 2px solid #1D42BA;">
                <strong>üìå Instructions:</strong>
                <ul style="margin: 10px 0 0 20px; text-align: left;">
                    <li>Use the <strong>üìù Show Your Work</strong> area to write your calculations and steps</li>
                    <li>Write your <strong>‚úì Final Answer</strong> in the answer box</li>
                    <li>Click the <strong>üî¢ calculator button</strong> (bottom right) for help with exponents and fractions</li>
                </ul>
            </div>
        </header>

        <form id="testForm">
            <!-- Question 1: Draw graph from table (Standard 3.a) -->
            <div class="question-card">
                <div class="question-number">Question 1 - Standard 3.a</div>
                <div class="question-text">
                    A rideshare driver tracks their daily earnings. Use the table below to analyze the relationship:
                </div>
                <table>
                    <tr>
                        <th>Hours (h)</th>
                        <th>Earnings ($)</th>
                    </tr>
                    <tr><td>2</td><td>60</td></tr>
                    <tr><td>4</td><td>110</td></tr>
                    <tr><td>6</td><td>160</td></tr>
                    <tr><td>8</td><td>210</td></tr>
                </table>
                <div class="question-text">
                    Write a linear equation in slope-intercept form that models the driver's earnings.
                </div>
                <div class="work-area">
                    <span class="work-label">üìù Show Your Work:</span>
                    <textarea placeholder="Write your calculations, steps, and reasoning here..."></textarea>
                </div>
                <div class="input-group">
                    <label>Final Answer:</label>
                    <input type="text" id="q1">
                </div>
                <button type="button" class="math-input-toggle" onclick="toggleMathInput(1)">üî¢ Math Input</button>
                <div class="math-input-panel" id="mathPanel1"></div>
                <div class="answer-feedback" id="feedback1"></div>
            </div>

            <!-- Question 2: Evaluate function from graph (Standard 3.b) -->
            <div class="question-card">
                <div class="question-number">Question 2 - Standard 3.b</div>
                <div class="question-text">
                    The graph shows a streaming service's monthly cost based on devices:
                </div>
                <div class="chart-container">
                    <canvas id="chart2"></canvas>
                </div>
                <div class="question-text">
                    a) What is the cost for 3 devices?
                    <br>b) How many devices can you have for $45?
                </div>
                <div class="work-area">
                    <span class="work-label">üìù Show Your Work:</span>
                    <textarea placeholder="Read values from graph, show your reasoning..."></textarea>
                </div>
                <div class="final-answer-box">
                    <label class="final-answer-label">‚úì Final Answers:</label>
                    <div class="input-group">
                        <label>a) Cost for 3 devices ($):</label>
                        <input type="number" id="q2a">
                    </div>
                    <div class="input-group">
                        <label>b) Devices for $45:</label>
                        <input type="number" id="q2b">
                    </div>
                </div>
                <button type="button" class="math-input-toggle" onclick="toggleMathInput(2)">üî¢ Math Input</button>
                <div class="math-input-panel" id="mathPanel2"></div>
                <div class="answer-feedback" id="feedback2"></div>
            </div>

            <!-- Question 3: Domain and range (Standard 3.c) -->
            <div class="question-card">
                <div class="question-number">Question 3 - Standard 3.c</div>
                <div class="question-text">
                    The graph shows a company's profit over 6 months:
                </div>
                <div class="chart-container">
                    <canvas id="chart3"></canvas>
                </div>
                <div class="work-area">
                    <span class="work-label">üìù Show Your Work:</span>
                    <textarea placeholder="Analyze the graph to find domain and range..."></textarea>
                </div>
                <div class="final-answer-box">
                    <label class="final-answer-label">‚úì Final Answers:</label>
                    <div class="question-text">
                        a) Domain minimum: <input type="number" id="q3a" style="width:80px"> 
                        Domain maximum: <input type="number" id="q3b" style="width:80px"> (months)
                        <br><br>
                        b) Range minimum: <input type="number" id="q3c" style="width:100px">
                        Range maximum: <input type="number" id="q3d" style="width:100px"> (dollars)
                    </div>
                </div>
                <button type="button" class="math-input-toggle" onclick="toggleMathInput(3)">üî¢ Math Input</button>
                <div class="math-input-panel" id="mathPanel3"></div>
                <div class="answer-feedback" id="feedback3"></div>
            </div>

            <!-- Question 4: Intercepts (Standard 3.d) -->
            <div class="question-card">
                <div class="question-number">Question 4 - Standard 3.d</div>
                <div class="question-text">
                    A water tank is being filled: <span class="math-notation">W(t) = 20t + 150</span>
                    <br><br>
                    a) Find the y-intercept and explain what it represents.
                    <br>b) If the tank holds 450 gallons, when is it full?
                </div>
                <div class="input-group">
                    <label>a) Y-intercept (gallons):</label>
                    <input type="number" id="q4a">
                </div>
                <div class="input-group">
                    <label>What does it mean?</label>
                    <textarea id="q4b"></textarea>
                </div>
                <div class="input-group">
                    <label>b) Time to fill (minutes):</label>
                    <input type="number" id="q4c">
                </div>
                <button type="button" class="math-input-toggle" onclick="toggleMathInput(4)">üî¢ Math Input</button>
                <div class="math-input-panel" id="mathPanel4"></div>
                <div class="answer-feedback" id="feedback4"></div>
            </div>

            <!-- Question 5: Real-life graph (Standard 3.e) -->
            <div class="question-card">
                <div class="question-number">Question 5 - Standard 3.e</div>
                <div class="question-text">
                    A candle starts at 8 inches and burns at 0.5 inches/hour.
                    <br><br>
                    a) Write equation for height <span class="math-notation">h</span> after <span class="math-notation">t</span> hours
                    <br>b) What is the slope? What does it mean?
                    <br>c) When does the candle burn out?
                </div>
                <div class="input-group">
                    <label>a) Equation:</label>
                    <input type="text" id="q5a">
                </div>
                <div class="input-group">
                    <label>b) Slope:</label>
                    <input type="number" step="0.1" id="q5b">
                </div>
                <div class="input-group">
                    <label>What does slope mean?</label>
                    <textarea id="q5c"></textarea>
                </div>
                <div class="input-group">
                    <label>c) Hours to burn out:</label>
                    <input type="number" id="q5d">
                </div>
                <button type="button" class="math-input-toggle" onclick="toggleMathInput(5)">üî¢ Math Input</button>
                <div class="math-input-panel" id="mathPanel5"></div>
                <div class="answer-feedback" id="feedback5"></div>
            </div>

            <!-- Question 6: Draw conclusions (Standard 3.f) -->
            <div class="question-card">
                <div class="question-number">Question 6 - Standard 3.f</div>
                <div class="question-text">
                    Temperature changes throughout a day:
                </div>
                <div class="chart-container">
                    <canvas id="chart6"></canvas>
                </div>
                <div class="work-area">
                    <span class="work-label">üìù Show Your Work:</span>
                    <textarea placeholder="Analyze graph, find slope from hour 6-8, extrapolate to hour 10..."></textarea>
                </div>
                <div class="final-answer-box">
                    <label class="final-answer-label">‚úì Final Answers:</label>
                    <div class="question-text">
                        a) When is temperature increasing? From hour <input type="number" id="q6a" style="width:60px"> to <input type="number" id="q6b" style="width:60px">
                        <br><br>
                        b) Maximum temperature: <input type="number" id="q6c" style="width:80px"> ¬∞F
                        <br><br>
                        c) If hour 6-8 trend continues, predict temp at hour 10: <input type="number" id="q6d" style="width:80px"> ¬∞F
                    </div>
                </div>
                <button type="button" class="math-input-toggle" onclick="toggleMathInput(6)">üî¢ Math Input</button>
                <div class="math-input-panel" id="mathPanel6"></div>
                <div class="answer-feedback" id="feedback6"></div>
            </div>

            <!-- Question 7: Inverse functions (Standard 3.g) -->
            <div class="question-card">
                <div class="question-number">Question 7 - Standard 3.g</div>
                <div class="question-text">
                    Concert tickets: <span class="math-notation">C(t) = 45t + 25</span>
                    <br><br>
                    a) Find inverse function <span class="math-notation">C<sup>-1</sup>(x)</span>
                    <br>b) If someone spent $385, how many tickets?
                </div>
                <div class="input-group">
                    <label>a) Inverse function:</label>
                    <input type="text" id="q7a">
                </div>
                <div class="input-group">
                    <label>b) Tickets for $385:</label>
                    <input type="number" id="q7b">
                </div>
                <button type="button" class="math-input-toggle" onclick="toggleMathInput(7)">üî¢ Math Input</button>
                <div class="math-input-panel" id="mathPanel7"></div>
                <div class="answer-feedback" id="feedback7"></div>
            </div>

            <!-- Question 8: Function operations (Standard 3.h) -->
            <div class="question-card">
                <div class="question-number">Question 8 - Standard 3.h</div>
                <div class="question-text">
                    Business functions:
                    <br>Revenue: <span class="math-notation">R(x) = 30x</span>
                    <br>Cost: <span class="math-notation">C(x) = 12x + 500</span>
                    <br><br>
                    a) Write profit function <span class="math-notation">P(x) = R(x) - C(x)</span>
                    <br>b) Break-even quantity?
                    <br>c) Profit for 50 products?
                </div>
                <div class="input-group">
                    <label>a) Profit function:</label>
                    <input type="text" id="q8a">
                </div>
                <div class="input-group">
                    <label>b) Break-even:</label>
                    <input type="number" step="0.01" id="q8b">
                </div>
                <div class="input-group">
                    <label>c) Profit for 50 ($):</label>
                    <input type="number" id="q8c">
                </div>
                <button type="button" class="math-input-toggle" onclick="toggleMathInput(8)">üî¢ Math Input</button>
                <div class="math-input-panel" id="mathPanel8"></div>
                <div class="answer-feedback" id="feedback8"></div>
            </div>

            <!-- Question 9: Solve in function notation (Standard 3.i) -->
            <div class="question-card">
                <div class="question-number">Question 9 - Standard 3.i</div>
                <div class="question-text">
                    Phone plan: <span class="math-notation">P(g) = 0.10g + 40</span>
                    <br><br>
                    a) If bill was $52, how many GB used?
                    <br>b) What's the bill for 75 GB?
                </div>
                <div class="input-group">
                    <label>a) GB used:</label>
                    <input type="number" id="q9a">
                </div>
                <div class="input-group">
                    <label>b) Bill for 75 GB ($):</label>
                    <input type="number" step="0.01" id="q9b">
                </div>
                <button type="button" class="math-input-toggle" onclick="toggleMathInput(9)">üî¢ Math Input</button>
                <div class="math-input-panel" id="mathPanel9"></div>
                <div class="answer-feedback" id="feedback9"></div>
            </div>

            <!-- Question 10: Identify linear patterns (Standard 4.a) -->
            <div class="question-card">
                <div class="question-number">Question 10 - Standard 4.a</div>
                <div class="question-text">
                    Gym: $35/month + $75 enrollment fee
                    <br><br>
                    a) Why is this linear?
                    <br>b) Write model <span class="math-notation">C(m)</span>
                </div>
                <div class="input-group">
                    <label>a) Why linear?</label>
                    <textarea id="q10a"></textarea>
                </div>
                <div class="input-group">
                    <label>b) Model:</label>
                    <input type="text" id="q10b">
                </div>
                <button type="button" class="math-input-toggle" onclick="toggleMathInput(10)">üî¢ Math Input</button>
                <div class="math-input-panel" id="mathPanel10"></div>
                <div class="answer-feedback" id="feedback10"></div>
            </div>

            <!-- Question 11: Write linear models (Standard 4.b) -->
            <div class="question-card">
                <div class="question-number">Question 11 - Standard 4.b</div>
                <div class="question-text">
                    Plumber: $85 service call + $60/hour
                    <br><br>
                    a) Write equation for cost <span class="math-notation">C</span> and hours <span class="math-notation">h</span>
                    <br>b) Cost for 3.5 hours?
                    <br>c) If charged $325, how many hours?
                </div>
                <div class="input-group">
                    <label>a) Equation:</label>
                    <input type="text" id="q11a">
                </div>
                <div class="input-group">
                    <label>b) Cost for 3.5 hours ($):</label>
                    <input type="number" id="q11b">
                </div>
                <div class="input-group">
                    <label>c) Hours for $325:</label>
                    <input type="number" id="q11c">
                </div>
                <button type="button" class="math-input-toggle" onclick="toggleMathInput(11)">üî¢ Math Input</button>
                <div class="math-input-panel" id="mathPanel11"></div>
                <div class="answer-feedback" id="feedback11"></div>
            </div>

            <!-- Question 12: Interpret slope/intercepts (Standard 4.c) -->
            <div class="question-card">
                <div class="question-number">Question 12 - Standard 4.c</div>
                <div class="question-text">
                    Car rental: <span class="math-notation">C = 0.25m + 40</span>
                    <br><br>
                    a) What does 0.25 represent?
                    <br>b) What does 40 represent?
                    <br>c) Cost for 200 miles?
                </div>
                <div class="input-group">
                    <label>a) Meaning of 0.25:</label>
                    <textarea id="q12a"></textarea>
                </div>
                <div class="input-group">
                    <label>b) Meaning of 40:</label>
                    <textarea id="q12b"></textarea>
                </div>
                <div class="input-group">
                    <label>c) Cost for 200 miles ($):</label>
                    <input type="number" id="q12c">
                </div>
                <button type="button" class="math-input-toggle" onclick="toggleMathInput(12)">üî¢ Math Input</button>
                <div class="math-input-panel" id="mathPanel12"></div>
                <div class="answer-feedback" id="feedback12"></div>
            </div>

            <!-- Question 13: Different equation forms (Standard 4.d) -->
            <div class="question-card">
                <div class="question-number">Question 13 - Standard 4.d</div>
                <div class="question-text">
                    Line through (3, 100) and (7, 180)
                    <br><br>
                    a) Find slope
                    <br>b) Write in point-slope form using (3, 100)
                    <br>c) Convert to slope-intercept form
                </div>
                <div class="input-group">
                    <label>a) Slope:</label>
                    <input type="number" id="q13a">
                </div>
                <div class="input-group">
                    <label>b) Point-slope form:</label>
                    <input type="text" id="q13b">
                </div>
                <div class="input-group">
                    <label>c) Slope-intercept form:</label>
                    <input type="text" id="q13c">
                </div>
                <button type="button" class="math-input-toggle" onclick="toggleMathInput(13)">üî¢ Math Input</button>
                <div class="math-input-panel" id="mathPanel13"></div>
                <div class="answer-feedback" id="feedback13"></div>
            </div>

            <!-- Question 14: Graph linear functions (Standard 4.e) -->
            <div class="question-card">
                <div class="question-number">Question 14 - Standard 4.e</div>
                <div class="question-text">
                    Savings: <span class="math-notation">S = 50m + 200</span>
                    <br><br>
                    a) Y-intercept?
                    <br>b) Slope?
                    <br>c) Amount after 6 months?
                    <br>d) Months to reach $500?
                </div>
                <div class="input-group">
                    <label>a) Y-intercept:</label>
                    <input type="number" id="q14a">
                </div>
                <div class="input-group">
                    <label>b) Slope:</label>
                    <input type="number" id="q14b">
                </div>
                <div class="input-group">
                    <label>c) Amount after 6 months ($):</label>
                    <input type="number" id="q14c">
                </div>
                <div class="input-group">
                    <label>d) Months for $500:</label>
                    <input type="number" id="q14d">
                </div>
                <button type="button" class="math-input-toggle" onclick="toggleMathInput(14)">üî¢ Math Input</button>
                <div class="math-input-panel" id="mathPanel14"></div>
                <div class="answer-feedback" id="feedback14"></div>
            </div>

            <!-- Question 15: Exponential models (Standard 5.a) -->
            <div class="question-card">
                <div class="question-number">Question 15 - Standard 5.a</div>
                <div class="question-text">
                    A population of bacteria doubles every 3 hours. The lab starts with 500 bacteria.
                    <br><br>
                    a) Explain why this situation is modeled by an exponential function, not linear.
                    <br>b) Write an exponential model <span class="math-notation">P(t) = a(b)<sup>t</sup></span> where t is the number of 3-hour periods.
                    <br>c) How many bacteria will there be after 9 hours (3 periods)?
                </div>
                <div class="input-group">
                    <label>a) Why exponential?</label>
                    <textarea id="q15a"></textarea>
                </div>
                <div class="input-group">
                    <label>b) Model P(t):</label>
                    <input type="text" id="q15b">
                </div>
                <div class="input-group">
                    <label>c) Bacteria after 9 hours:</label>
                    <input type="number" id="q15c">
                </div>
                <button type="button" class="math-input-toggle" onclick="toggleMathInput(15)">üî¢ Math Input</button>
                <div class="math-input-panel" id="mathPanel15"></div>
                <div class="answer-feedback" id="feedback15"></div>
            </div>

            <!-- Question 16: Exponential growth/decay (Standard 5.b & 5.c) -->
            <div class="question-card">
                <div class="question-number">Question 16 - Standard 5.b & 5.c</div>
                <div class="question-text">
                    A car's value depreciates by 15% each year. You bought it for $28,000.
                    <br><br>
                    a) Write an exponential model <span class="math-notation">V(t) = a(1 + r)<sup>t</sup></span> for the car's value after t years.
                    <br>b) What will the car be worth after 4 years?
                    <br>c) Is this exponential growth or decay? Explain how you know.
                </div>
                <div class="input-group">
                    <label>a) Model V(t):</label>
                    <input type="text" id="q16a">
                </div>
                <div class="input-group">
                    <label>b) Value after 4 years ($):</label>
                    <input type="number" step="0.01" id="q16b">
                </div>
                <div class="input-group">
                    <label>c) Growth or decay? Why?</label>
                    <textarea id="q16c"></textarea>
                </div>
                <button type="button" class="math-input-toggle" onclick="toggleMathInput(16)">üî¢ Math Input</button>
                <div class="math-input-panel" id="mathPanel16"></div>
                <div class="answer-feedback" id="feedback16"></div>
            </div>

            <button type="button" class="print-btn" onclick="printTest()">üñ®Ô∏è Print Version (Black & White)</button>
            <button type="button" class="answer-key-btn" onclick="showCalcAnswerKey()">üìã View Answer Key</button>
            <button type="button" class="submit-btn" onclick="gradeCalcTest()">Submit Test</button>
        </form>

        <div class="result" id="finalResult"></div>
    </div>

    <!-- Answer Key Modal -->
    <div id="answerKeyModal" class="answer-key-modal">
        <div class="answer-key-content">
            <button class="close-modal" onclick="closeAnswerKey()">√ó</button>
            <h2 class="answer-key-title">üìã Answer Key</h2>
            <div id="answerKeyBody"></div>
        </div>
    </div>

    <script src="shared/scripts.js"></script>
    <script>
        // Chart 2
        new Chart(document.getElementById('chart2'), {
            type: 'line',
            data: {
                labels: [0, 1, 2, 3, 4, 5],
                datasets: [{
                    label: 'Monthly Cost ($)',
                    data: [15, 21, 27, 33, 39, 45],
                    borderColor: MCM_CHART_COLORS.primary,
                    borderWidth: 3,
                    pointRadius: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { title: { display: true, text: 'Cost vs Devices', font: { size: 18 } } },
                scales: {
                    x: { title: { display: true, text: 'Devices', font: { size: 16 } }, ticks: { font: { size: 14 } } },
                    y: { title: { display: true, text: 'Cost ($)', font: { size: 16 } }, ticks: { font: { size: 14 } }, beginAtZero: true }
                }
            }
        });

        // Chart 3
        new Chart(document.getElementById('chart3'), {
            type: 'line',
            data: {
                labels: [0, 1, 2, 3, 4, 5, 6],
                datasets: [{
                    label: 'Profit ($)',
                    data: [5000, 7500, 10000, 12500, 15000, 17500, 20000],
                    borderColor: MCM_CHART_COLORS.secondary,
                    borderWidth: 3,
                    pointRadius: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { title: { display: true, text: 'Profit Over Time', font: { size: 18 } } },
                scales: {
                    x: { title: { display: true, text: 'Months', font: { size: 16 } }, ticks: { font: { size: 14 } } },
                    y: { title: { display: true, text: 'Profit ($)', font: { size: 16 } }, ticks: { font: { size: 14 } } }
                }
            }
        });

        // Chart 6
        new Chart(document.getElementById('chart6'), {
            type: 'line',
            data: {
                labels: [0, 2, 4, 6, 8],
                datasets: [{
                    label: 'Temperature (¬∞F)',
                    data: [50, 58, 66, 74, 70],
                    borderColor: '#E8A317',
                    borderWidth: 3,
                    pointRadius: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { title: { display: true, text: 'Temperature vs Time', font: { size: 18 } } },
                scales: {
                    x: { title: { display: true, text: 'Hour', font: { size: 16 } }, ticks: { font: { size: 14 } } },
                    y: { title: { display: true, text: 'Temp (¬∞F)', font: { size: 16 } }, ticks: { font: { size: 14 } }, min: 40, max: 80 }
                }
            }
        });

        // Grading logic ‚Äî preserved exactly for math accuracy
        const answers = {
            q1: 'y=25x+10', q2a: 33, q2b: 5, q3a: 0, q3b: 6, q3c: 5000, q3d: 20000,
            q4a: 150, q4b: 'initial', q4c: 15, q5a: 'h=8-0.5t', q5b: -0.5, q5c: 'burn', q5d: 16,
            q6a: 0, q6b: 6, q6c: 74, q6d: 66, q7a: 't=(c-25)/45', q7b: 8,
            q8a: 'p(x)=18x-500', q8b: 27.78, q8c: 400, q9a: 120, q9b: 47.50,
            q10a: 'constant', q10b: 'c(m)=35m+75', q11a: 'c=60h+85', q11b: 295, q11c: 4,
            q12a: 'per mile', q12b: 'base', q12c: 90, q13a: 20, q13b: 'y-100=20(x-3)', q13c: 'y=20x+40',
            q14a: 200, q14b: 50, q14c: 500, q14d: 6,
            q15a: 'multiply', q15b: 'p(t)=500(2)^t', q15c: 4000,
            q16a: 'v(t)=28000(0.85)^t', q16b: 14616.18, q16c: 'decay'
        };

        function norm(a) {
            return typeof a === 'string' ? a.toLowerCase().replace(/\s+|\*|\$/g, '') : a;
        }

        function check(user, correct, tol = 0.5) {
            if (typeof correct === 'number') return Math.abs(parseFloat(user) - correct) <= tol;
            const u = norm(user), c = norm(correct);
            return c.includes('initial') || c.includes('burn') || c.includes('constant') || c.includes('per') || c.includes('base') || c.includes('multiply') || c.includes('decay') ? u.includes(c.substring(0, 4)) : u === c;
        }

        // Grading uses shared gradeTest() from scripts.js
        function gradeCalcTest() {
            var calcFeedbacks = [
                ['‚úì y = 25x + 10', '‚úó Slope=(110-60)/(4-2)=25, b=10'],
                ['‚úì $33', '‚úó Read graph at x=3', '‚úì 5 devices', '‚úó Find where y=45'],
                ['‚úì 0', '‚úó Min month: 0', '‚úì 6', '‚úó Max month: 6', '‚úì $5000', '‚úó Min: $5000', '‚úì $20000', '‚úó Max: $20000'],
                ['‚úì 150', '‚úó W(0)=150', '‚úì Initial water', '‚úó Starting amount', '‚úì 15 min', '‚úó 450=20t+150‚Üít=15'],
                ['‚úì h=8-0.5t', '‚úó h=8-0.5t', '‚úì -0.5', '‚úó Slope=-0.5', '‚úì Burn rate', '‚úó Rate of decrease', '‚úì 16 hr', '‚úó 0=8-0.5t‚Üít=16'],
                ['‚úì 0', '‚úó Starts at 0', '‚úì 6', '‚úó Increases to 6', '‚úì 74¬∞F', '‚úó Max is 74', '‚úì 66¬∞F', '‚úó Rate: -2¬∞F/hr ‚Üí 70-4 = 66'],
                ['‚úì t=(C-25)/45', '‚úó Solve for t', '‚úì 8 tickets', '‚úó (385-25)/45=8'],
                ['‚úì P(x)=18x-500', '‚úó 30x-(12x+500)', '‚úì 27.78', '‚úó 0=18x-500', '‚úì $400', '‚úó 18(50)-500=400'],
                ['‚úì 120 GB', '‚úó 52=0.10g+40', '‚úì $47.50', '‚úó 0.10(75)+40=47.50'],
                ['‚úì Constant rate', '‚úó Same monthly charge', '‚úì C(m)=35m+75', '‚úó 35m+75'],
                ['‚úì C=60h+85', '‚úó 60h+85', '‚úì $295', '‚úó 60(3.5)+85=295', '‚úì 4 hours', '‚úó 325=60h+85‚Üíh=4'],
                ['‚úì Cost per mile', '‚úó $0.25/mile', '‚úì Base fee', '‚úó Fixed charge', '‚úì $90', '‚úó 0.25(200)+40=90'],
                ['‚úì 20', '‚úó (180-100)/(7-3)=20', '‚úì y-100=20(x-3)', '‚úó Point-slope', '‚úì y=20x+40', '‚úó Expand equation'],
                ['‚úì 200', '‚úó Initial: 200', '‚úì 50', '‚úó Rate: 50', '‚úì $500', '‚úó 50(6)+200=500', '‚úì 6 months', '‚úó 500=50m+200‚Üím=6'],
                ['‚úì Multiplies/doubles', '‚úó Repeated multiplication', '‚úì P(t)=500(2)^t', '‚úó 500(2)^t', '‚úì 4000', '‚úó 500(2)^3=4000'],
                ['‚úì V(t)=28000(0.85)^t', '‚úó 28000(1-0.15)^t', '‚úì $14,616.18', '‚úó 28000(0.85)^4‚âà14616.18', '‚úì Decay', '‚úó Less than 1, decreasing']
            ];

            gradeTest({
                questions: [
                    [[['q1', answers.q1]], 'feedback1'],
                    [[['q2a', answers.q2a], ['q2b', answers.q2b]], 'feedback2'],
                    [[['q3a', answers.q3a], ['q3b', answers.q3b], ['q3c', answers.q3c], ['q3d', answers.q3d]], 'feedback3'],
                    [[['q4a', answers.q4a], ['q4b', answers.q4b], ['q4c', answers.q4c]], 'feedback4'],
                    [[['q5a', answers.q5a], ['q5b', answers.q5b], ['q5c', answers.q5c], ['q5d', answers.q5d]], 'feedback5'],
                    [[['q6a', answers.q6a], ['q6b', answers.q6b], ['q6c', answers.q6c], ['q6d', answers.q6d]], 'feedback6'],
                    [[['q7a', answers.q7a], ['q7b', answers.q7b]], 'feedback7'],
                    [[['q8a', answers.q8a], ['q8b', answers.q8b, 1], ['q8c', answers.q8c]], 'feedback8'],
                    [[['q9a', answers.q9a], ['q9b', answers.q9b]], 'feedback9'],
                    [[['q10a', answers.q10a], ['q10b', answers.q10b]], 'feedback10'],
                    [[['q11a', answers.q11a], ['q11b', answers.q11b], ['q11c', answers.q11c]], 'feedback11'],
                    [[['q12a', answers.q12a], ['q12b', answers.q12b], ['q12c', answers.q12c]], 'feedback12'],
                    [[['q13a', answers.q13a], ['q13b', answers.q13b], ['q13c', answers.q13c]], 'feedback13'],
                    [[['q14a', answers.q14a], ['q14b', answers.q14b], ['q14c', answers.q14c], ['q14d', answers.q14d]], 'feedback14'],
                    [[['q15a', answers.q15a], ['q15b', answers.q15b], ['q15c', answers.q15c]], 'feedback15'],
                    [[['q16a', answers.q16a], ['q16b', answers.q16b, 2], ['q16c', answers.q16c]], 'feedback16']
                ],
                standards: [
                    {id: '4.c', name: 'Equations from points'},
                    {id: '3.d', name: 'Graph analysis'},
                    {id: '3.d', name: 'Graph analysis'},
                    {id: '3.e', name: 'Real-life applications'},
                    {id: '4.b', name: 'Write linear models'},
                    {id: '3.f', name: 'Drawing conclusions'},
                    {id: '2.b', name: 'Literal equations'},
                    {id: '3.e', name: 'Real-life applications'},
                    {id: '1.c', name: 'Real-life models'},
                    {id: '4.b', name: 'Write linear models'},
                    {id: '4.b', name: 'Write linear models'},
                    {id: '3.e', name: 'Real-life applications'},
                    {id: '4.c', name: 'Equations from points'},
                    {id: '4.b', name: 'Write linear models'},
                    {id: '5.b', name: 'Exponential growth'},
                    {id: '5.c', name: 'Exponential decay'}
                ],
                storageKey: 'mcm-index-calc-results'
            });
        }

        function showCalcAnswerKey() {
            var answerKeyHTML = '<div class="answer-item"><strong>Q1:</strong> y = 25x + 10 (Slope = (110-60)/(4-2) = 25, y-intercept = 10)</div>' +
                '<div class="answer-item"><strong>Q2a:</strong> $33<br><strong>Q2b:</strong> 5 devices</div>' +
                '<div class="answer-item"><strong>Q3a:</strong> Domain: 0 to 6 months<br><strong>Q3b:</strong> Range: $5,000 to $20,000</div>' +
                '<div class="answer-item"><strong>Q4a:</strong> 150 gallons (initial water in tank)<br><strong>Q4b:</strong> Represents the starting amount of water<br><strong>Q4c:</strong> 15 minutes</div>' +
                '<div class="answer-item"><strong>Q5a:</strong> h = 8 - 0.5t<br><strong>Q5b:</strong> -0.5 (burn rate per hour)<br><strong>Q5c:</strong> Rate at which candle burns down<br><strong>Q5d:</strong> 16 hours</div>' +
                '<div class="answer-item"><strong>Q6a:</strong> Hour 0 to 6<br><strong>Q6b:</strong> 74¬∞F<br><strong>Q6c:</strong> 66¬∞F (slope = -2¬∞F/hr, so 70 + 2(-2) = 66)</div>' +
                '<div class="answer-item"><strong>Q7a:</strong> t = (C - 25)/45<br><strong>Q7b:</strong> 8 tickets</div>' +
                '<div class="answer-item"><strong>Q8a:</strong> P(x) = 18x - 500<br><strong>Q8b:</strong> 27.78 products<br><strong>Q8c:</strong> $400 profit</div>' +
                '<div class="answer-item"><strong>Q9a:</strong> 120 GB<br><strong>Q9b:</strong> $47.50</div>' +
                '<div class="answer-item"><strong>Q10a:</strong> Constant rate of change (same amount added each month)<br><strong>Q10b:</strong> C(m) = 35m + 75</div>' +
                '<div class="answer-item"><strong>Q11a:</strong> C = 60h + 85<br><strong>Q11b:</strong> $295<br><strong>Q11c:</strong> 4 hours</div>' +
                '<div class="answer-item"><strong>Q12a:</strong> Cost per mile driven ($0.25/mile)<br><strong>Q12b:</strong> Base/fixed rental fee ($40)<br><strong>Q12c:</strong> $90</div>' +
                '<div class="answer-item"><strong>Q13a:</strong> 20 (slope = (180-100)/(7-3))<br><strong>Q13b:</strong> y - 100 = 20(x - 3)<br><strong>Q13c:</strong> y = 20x + 40</div>' +
                '<div class="answer-item"><strong>Q14a:</strong> 200 (initial savings)<br><strong>Q14b:</strong> 50 (monthly savings)<br><strong>Q14c:</strong> $500<br><strong>Q14d:</strong> 6 months</div>' +
                '<div class="answer-item"><strong>Q15a:</strong> Multiplies by same factor (doubles) repeatedly, not adding constant<br><strong>Q15b:</strong> P(t) = 500(2)^t<br><strong>Q15c:</strong> 4,000 bacteria</div>' +
                '<div class="answer-item"><strong>Q16a:</strong> V(t) = 28000(0.85)^t<br><strong>Q16b:</strong> $14,616.18<br><strong>Q16c:</strong> Decay - base is less than 1, value decreases over time</div>';
            showAnswerKey(answerKeyHTML);
        }

        // Math Input Panel Functions
        let currentPanel = null;
        let currentInput = null;

        // Initialize all math panels on page load
        window.addEventListener('DOMContentLoaded', function() {
            initMathPanels();
        });

        function initMathPanels() {
            for (let i = 1; i <= 16; i++) {
                const panel = document.getElementById('mathPanel' + i);
                if (panel) {
                    panel.innerHTML = `
                        <div class="math-display" id="mathDisplay${i}"></div>
                        <div class="math-controls">
                            <button type="button" class="math-insert-btn" onclick="insertToInput(${i})">Insert into Answer</button>
                            <button type="button" class="math-clear-btn" onclick="clearMathDisplay(${i})">Clear</button>
                        </div>
                        <div class="math-buttons">
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, 'x')">x</button>
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, 'y')">y</button>
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, 't')">t</button>
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, 'h')">h</button>
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, 'm')">m</button>
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, '=')"> = </button>
                            
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, '0')">0</button>
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, '1')">1</button>
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, '2')">2</button>
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, '3')">3</button>
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, '4')">4</button>
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, '5')">5</button>
                            
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, '6')">6</button>
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, '7')">7</button>
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, '8')">8</button>
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, '9')">9</button>
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, '.')">.</button>
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, ' ')">Space</button>
                            
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, '+')"> + </button>
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, '-')"> ‚àí </button>
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, '√ó')"> √ó </button>
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, '√∑')"> √∑ </button>
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, '(')">(</button>
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, ')')">)</button>
                            
                            <button type="button" class="math-btn special" onclick="insertFraction(${i})">a/b</button>
                            <button type="button" class="math-btn special" onclick="insertExponent(${i})">x¬≤</button>
                            <button type="button" class="math-btn special" onclick="insertSuperscript(${i}, '3')">x¬≥</button>
                            <button type="button" class="math-btn special" onclick="insertSqrt(${i})">‚àö</button>
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, '‚â§')"> ‚â§ </button>
                            <button type="button" class="math-btn" onclick="addToMathDisplay(${i}, '‚â•')"> ‚â• </button>
                        </div>
                    `;
                }
            }
        }

        function toggleMathInput(questionNum) {
            const panel = document.getElementById('mathPanel' + questionNum);
            const allPanels = document.querySelectorAll('.math-input-panel');
            
            // Close all other panels
            allPanels.forEach(p => {
                if (p !== panel) {
                    p.classList.remove('show');
                }
            });
            
            // Toggle current panel
            panel.classList.toggle('show');
        }

        function addToMathDisplay(questionNum, symbol) {
            const display = document.getElementById('mathDisplay' + questionNum);
            // If there's a focused input within the display, add to it
            const focusedInput = display.querySelector('input:focus');
            if (focusedInput) {
                focusedInput.value += symbol;
            } else {
                // Otherwise add to the end of the display
                const span = document.createElement('span');
                span.textContent = symbol;
                display.appendChild(span);
            }
        }

        function clearMathDisplay(questionNum) {
            const display = document.getElementById('mathDisplay' + questionNum);
            display.innerHTML = '';
        }

        function insertFraction(questionNum) {
            const display = document.getElementById('mathDisplay' + questionNum);
            
            // Create fraction structure with editable inputs
            const fractionWrapper = document.createElement('span');
            fractionWrapper.style.cssText = 'display:inline-block; vertical-align:middle; text-align:center; margin:0 3px;';
            
            const numerator = document.createElement('input');
            numerator.type = 'text';
            numerator.style.cssText = 'width:40px; text-align:center; border:none; border-bottom:2px solid #333; background:transparent; font-size:1em; padding:2px;';
            numerator.placeholder = '?';
            
            const denominator = document.createElement('input');
            denominator.type = 'text';
            denominator.style.cssText = 'width:40px; text-align:center; border:none; background:transparent; font-size:1em; padding:2px; margin-top:2px;';
            denominator.placeholder = '?';
            
            const numWrapper = document.createElement('div');
            numWrapper.appendChild(numerator);
            const denomWrapper = document.createElement('div');
            denomWrapper.appendChild(denominator);
            
            fractionWrapper.appendChild(numWrapper);
            fractionWrapper.appendChild(denomWrapper);
            display.appendChild(fractionWrapper);
            
            // Focus the numerator
            numerator.focus();
        }

        function insertExponent(questionNum) {
            const display = document.getElementById('mathDisplay' + questionNum);
            
            // Create exponent structure with editable input
            const expWrapper = document.createElement('span');
            expWrapper.style.cssText = 'display:inline-block; vertical-align:top; margin:0 2px;';
            
            const expInput = document.createElement('input');
            expInput.type = 'text';
            expInput.style.cssText = 'width:30px; text-align:center; border:1px solid #999; background:#fff; font-size:0.8em; padding:2px; vertical-align:super;';
            expInput.placeholder = '?';
            
            expWrapper.appendChild(document.createTextNode('^'));
            expWrapper.appendChild(expInput);
            display.appendChild(expWrapper);
            
            // Focus the input
            expInput.focus();
        }

        function insertSuperscript(questionNum, power) {
            const display = document.getElementById('mathDisplay' + questionNum);
            
            // Create superscript with specified power
            const supWrapper = document.createElement('span');
            supWrapper.style.cssText = 'vertical-align:super; font-size:0.8em;';
            supWrapper.textContent = power;
            
            display.appendChild(document.createTextNode('^'));
            display.appendChild(supWrapper);
        }

        function insertSqrt(questionNum) {
            const display = document.getElementById('mathDisplay' + questionNum);
            
            // Create sqrt structure with editable input
            const sqrtWrapper = document.createElement('span');
            sqrtWrapper.style.cssText = 'display:inline-block; margin:0 2px;';
            
            const sqrtInput = document.createElement('input');
            sqrtInput.type = 'text';
            sqrtInput.style.cssText = 'width:50px; text-align:center; border:1px solid #999; background:#fff; font-size:1em; padding:2px;';
            sqrtInput.placeholder = '?';
            
            sqrtWrapper.appendChild(document.createTextNode('‚àö('));
            sqrtWrapper.appendChild(sqrtInput);
            sqrtWrapper.appendChild(document.createTextNode(')'));
            display.appendChild(sqrtWrapper);
            
            // Focus the input
            sqrtInput.focus();
        }

        function insertToInput(questionNum) {
            const display = document.getElementById('mathDisplay' + questionNum);
            
            // Clone the display content to preserve formatting
            const clonedContent = display.cloneNode(true);
            
            // Convert input elements to their values in the clone
            clonedContent.querySelectorAll('input').forEach(input => {
                const textNode = document.createTextNode(input.value || '?');
                input.parentNode.replaceChild(textNode, input);
            });
            
            // Find the first text input in this question
            const questionCard = document.getElementById('mathPanel' + questionNum).closest('.question-card');
            let targetInput = questionCard.querySelector('input[type="text"]');
            
            if (targetInput) {
                // Convert the input to a contenteditable div to support HTML formatting
                const contentDiv = document.createElement('div');
                contentDiv.contentEditable = true;
                contentDiv.id = targetInput.id;
                contentDiv.className = 'math-answer-input';
                contentDiv.style.cssText = 'min-height: 40px; padding: 12px; border: 2px solid #ddd; border-radius: 8px; background: white; font-size: 1.3em; font-family: "Times New Roman", serif; display: flex; align-items: center; flex-wrap: wrap;';
                
                // Copy the formatted content
                contentDiv.innerHTML = clonedContent.innerHTML;
                
                // Replace the input with the div
                targetInput.parentNode.replaceChild(contentDiv, targetInput);
                
                // Focus the new div
                contentDiv.focus();
                
                // Move cursor to end
                const range = document.createRange();
                const sel = window.getSelection();
                range.selectNodeContents(contentDiv);
                range.collapse(false);
                sel.removeAllRanges();
                sel.addRange(range);
            }
        }
    </script>

    <nav class="test-nav" role="navigation" aria-label="Page navigation" style="text-align:center; padding:20px 0; font-size:0.95em;">
        <a href="index.html" style="color:var(--accent-blue); font-weight:600; margin-right:16px;">‚Üê Dashboard</a>
        <a href="parent.html" style="color:var(--accent-navy); font-weight:600;">üìä Parent View</a>
    </nav></body>
</html>
