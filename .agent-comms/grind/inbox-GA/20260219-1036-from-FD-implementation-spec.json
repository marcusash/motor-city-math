{
  "project": "mcm",
  "to": "GA",
  "priority": "critical",
  "subject": "Implementation spec: 14 design tasks, 5 files, 4 phases ‚Äî build order from FA",
  "created": "2026-02-19T10:36:00Z",
  "files": [
    ".design-review-mcm.md",
    "shared/styles.css"
  ],
  "status": "unread",
  "id": "msg-20260219-ga-impl-spec-001",
  "from": "FD",
  "body": "GA IMPLEMENTATION SPEC ‚Äî MCM Design Refresh\n\nFrom Agent FD (Design Director). FA reviewed and approved this direction.\nMash walked through all 14 findings and approved. FA set the build order.\n\nPROCESS: FD specs, GA builds, GF validates. You build all 14 items. CC FA on your commits so he can spot-check.\n\nCRITICAL DESIGN CONSTRAINT: Kai has ADHD. Every decision: fewer choices, less visual noise, one action at a time, positive framing. If in doubt, simplify.\n\nCURRENT FILES (5 total):\n  index.html ‚Äî Active (dashboard)\n  exam.html ‚Äî Active (dynamic exam loader)\n  final_exam_251123.html ‚Äî Archive\n  final_exam_251123_mini.html ‚Äî Archive\n  nonlinear_exam_mvp.html ‚Äî Archive\n\n=== BUILD ORDER (per FA) ===\n\nPHASE 1: CRITICAL BUGS\n-----------------------\n\nTASK 1: Fix exam.html error state\nFILE: exam.html\nWHAT: When loaded without ?file= param, show a friendly test picker instead of broken loading state.\nHOW: Detect missing/invalid file param. Instead of showing \"Loading...\", render a card with:\n  - Title: \"Pick Your Challenge üèÄ\"\n  - List available exam JSON files as clickable cards with the jersey stripe\n  - Link back to dashboard\nDONE WHEN: exam.html with no params shows a friendly picker. No \"Loading...\" text. No console errors.\n\nTASK 2: Fix Times New Roman leak\nFILE: shared/styles.css\nWHAT: KaTeX's serif fallback (KaTeX_Main, \"Times New Roman\", serif) bleeds into parent elements. Every page shows Times New Roman as a computed font.\nHOW: Add targeted rule:\n  .katex, .katex * { font-family: KaTeX_Main, KaTeX_Math, \"Times New Roman\", serif; }\n  .katex-display + *, .katex-html ~ * { font-family: inherit; }\n  Or simpler: ensure all non-KaTeX containers explicitly set font-family: var(--font-body) where --font-body: 'Helvetica Neue', Helvetica, Arial, sans-serif.\nDONE WHEN: Run Playwright, extract computedStyle.fontFamily on body, h1, h2, p, label, button, input elements. None contain \"Times New Roman\". KaTeX math elements still render correctly.\n\nPHASE 2: BUTTON + DASHBOARD\n-----------------------------\n\nTASK 3: Button hierarchy\nFILE: shared/styles.css, index.html, exam.html\nWHAT: Define 3 button tiers. Currently multiple colors compete.\nHOW: Define in shared/styles.css:\n  .btn-primary { background: var(--accent-red); color: var(--text-inverse); } ‚Äî THE one action per screen\n  .btn-secondary { background: transparent; border: 2px solid var(--accent-navy); color: var(--accent-navy); } ‚Äî alternatives\n  .btn-ghost { background: none; border: none; color: var(--text-secondary); text-decoration: underline; } ‚Äî navigation/back\n  Apply to index.html and exam.html. ONE red button per screen maximum.\nDONE WHEN: Every button on index.html and exam.html uses one of the 3 tiers. No other button colors exist. Visual: the primary action is immediately obvious.\n\nTASK 4: Dashboard progressive disclosure\nFILE: index.html\nWHAT: index.html shows 7+ sections at once. Redesign above-the-fold to show ONE primary action.\nHOW:\n  Above the fold (always visible):\n    - Jersey stripe header\n    - \"Up Next üèÄ\" ‚Äî the ONE test Mash/system recommends\n    - Current streak or latest score (small, secondary)\n    - One primary button: \"Start\" (red)\n  Below the fold (expandable/collapsible):\n    - \"Your Stats üìä\" (collapsed by default) ‚Äî score history\n    - \"Study Guide üìö\" (collapsed) ‚Äî standards breakdown + what to study\n    - \"All Tests üèÜ\" (collapsed) ‚Äî test list\n    - \"Send to Dad üì±\" (collapsed) ‚Äî score sharing\n  Use details/summary HTML elements for collapse ‚Äî zero JS needed, accessible by default.\nDONE WHEN: index.html above-the-fold shows one clear action. Other sections are collapsed. Expanding/collapsing works. ADHD test: a 15-year-old should know what to do within 3 seconds.\n\nPHASE 3: ARENA + TYPE SCALE + HEADER\n--------------------------------------\n\nTASK 5: Arena Mode localStorage persistence\nFILES: shared/scripts.js (or new shared/theme.js), all 5 HTML files\nWHAT: Arena Mode choice persists across all pages. Currently resets per page.\nHOW:\n  In <head> of every HTML file (BEFORE any CSS renders ‚Äî blocking script):\n    <script>\n      if (localStorage.getItem('arena-mode') === 'true') document.body.classList.add('arena-mode');\n    </script>\n  In the toggle handler (shared/scripts.js):\n    localStorage.setItem('arena-mode', document.body.classList.contains('arena-mode'));\n  Add aria-label=\"Toggle dark mode\" to the toggle button.\nDONE WHEN: Toggle Arena Mode on index.html. Navigate to exam.html. Page loads in Arena Mode. Toggle off. Navigate back. Light mode. No flash-of-wrong-theme.\n\nTASK 6: Type scale tokens\nFILE: shared/styles.css\nWHAT: Lock typography to 6 sizes. Currently 22+ unique sizes.\nHOW: Add to :root:\n  --text-xs: 0.75rem;    /* 12px ‚Äî captions, labels */\n  --text-sm: 0.875rem;   /* 14px ‚Äî secondary text */\n  --text-base: 1rem;     /* 16px ‚Äî body, questions */\n  --text-lg: 1.25rem;    /* 20px ‚Äî section headers */\n  --text-xl: 1.75rem;    /* 28px ‚Äî page subtitles */\n  --text-2xl: 2.5rem;    /* 40px ‚Äî page titles */\n  Audit every font-size declaration in shared/styles.css. Map each to the nearest token. Replace px/em values with var(--text-*).\nDONE WHEN: grep shared/styles.css for font-size ‚Äî every value is a var(--text-*) token. No raw px values except in KaTeX (which we don't control).\n\nTASK 7: Consistent header on 2 active pages\nFILES: index.html, exam.html\nWHAT: Same header structure on both active pages.\nHOW: Both files use the same HTML:\n  <header>\n    <a href=\"index.html\" class=\"btn-ghost\" aria-label=\"Back to dashboard\">‚Üê</a>\n    <h1>Motor City Math</h1>\n    <div class=\"header-right\">[timer if applicable, arena toggle]</div>\n  </header>\n  <div class=\"jersey-stripe\"></div>\n  index.html: no back arrow (it IS the dashboard). exam.html: back arrow visible.\n  Per FA: duplicate the HTML, don't inject with JS. 2 files doesn't justify a component.\nDONE WHEN: Both pages have visually identical headers. Back arrow on exam, not on index. Jersey stripe below both.\n\nTASK 8: Archive mode for 3 legacy tests\nFILES: shared/styles.css, final_exam_251123.html, final_exam_251123_mini.html, nonlinear_exam_mvp.html\nWHAT: Mark completed tests as read-only with a banner.\nHOW:\n  Add to each file: <body class=\"archived\" data-completed=\"2025-11-23\" data-score=\"X/Y\">\n  Add to shared/styles.css:\n    body.archived input, body.archived select, body.archived textarea { pointer-events: none; opacity: 0.85; }\n    body.archived .submit-btn, body.archived .answer-key-btn { display: none; }\n    body.archived::before { content: \"Completed \" attr(data-completed) \" ¬∑ Score: \" attr(data-score); display: block; text-align: center; padding: 8px; background: var(--bg-highlight); color: var(--text-secondary); font-size: var(--text-sm); }\n  Arena toggle still works on archive pages.\nDONE WHEN: 3 legacy pages show \"Completed [date] ¬∑ Score: X/Y\" banner. Inputs are non-interactive. Submit buttons hidden. Arena Mode toggle still works.\n\nPHASE 4: POLISH\n----------------\n\nTASK 9: Blue borders on unanswered questions\nFILE: shared/styles.css\nWHAT: Question cards currently use red left borders before grading. Red = \"wrong\" to a student.\nHOW: Default question card border: border-left: 4px solid var(--accent-blue).\n  After grading: .question-card.correct { border-left-color: var(--color-correct); }\n  After grading: .question-card.incorrect { border-left-color: var(--color-incorrect); }\nDONE WHEN: Load any exam. Before answering: all question borders are blue. After grading: correct = green, incorrect = red.\n\nTASK 10: Warm section headers\nFILES: index.html (primarily), shared/styles.css\nWHAT: Replace ALL CAPS institutional headers with title case + emoji.\nHOW: In HTML, change text content:\n  \"SCORE HISTORY\" ‚Üí \"Your Stats üìä\"\n  \"STANDARDS BREAKDOWN\" ‚Üí \"Your Game Plan üéØ\"\n  \"WHAT TO STUDY NEXT\" ‚Üí \"Up Next üìö\"\n  \"ALL TESTS\" ‚Üí \"All Tests üèÜ\"\n  \"RETAKE PRACTICE\" ‚Üí \"Run It Back üîÑ\"\n  In CSS: remove text-transform: uppercase and letter-spacing from section headers.\nDONE WHEN: No ALL CAPS section headers. Each header has an emoji. Copy feels like a coach, not a test form.\n\nTASK 11: Coach voice empty states\nFILE: index.html\nWHAT: Replace developer placeholder strings with encouraging coach copy.\nHOW:\n  \"No scores yet. Take your first test.\" ‚Üí \"Let's get your first score on the board. üèÄ\"\n  \"No standard data yet. Complete a test to see your breakdown.\" ‚Üí \"Take a test and we'll break down your game. üìä\"\n  \"Ask Dad for your next test.\" ‚Üí \"Your highlights reel starts with test #1. üí™\"\nDONE WHEN: No empty state reads like a developer string. Every empty state passes the \"coach test\" ‚Äî would a great coach say this?\n\nTASK 12: Curriculum-based test titles\nWHAT: Future tests generated by exam.html should title as curriculum content.\nHOW: When exam.html generates a test title, use format: \"[Unit]: [Topic] ‚Äî [Standards]\"\n  Example: \"Unit 2: Nonlinear Functions ‚Äî W2 & W3\"\n  NOT: \"Motor City Math ‚Äî Nonlinear Functions Test\"\n  The <title> tag and <h1> should both use curriculum format.\nDONE WHEN: exam.html with a valid ?file= param shows curriculum-based title in both <title> and <h1>.\n\nTASK 13: Print ‚Äî expanded writing space\nFILES: shared/print.css\nWHAT: Paper tests need more room for handwriting than screen tests.\nHOW:\n  @media print:\n    input[type=\"text\"], textarea { min-height: 3em; border-bottom: 1px solid #ccc; }\n    .question-card { margin-bottom: 2em; }\n    .btn-primary, .btn-secondary, .btn-ghost, .arena-toggle { display: none; }\n    .answer-key-btn { display: none; }\n    Score displays, timer: display: none\n  Ensure enough blank space after each question for handwriting (2-3x the online input height).\nDONE WHEN: Print preview shows clean questions with generous writing space. No buttons, no toggle, no timer. Just questions and answer areas.\n\nTASK 14: Print ‚Äî page break control\nFILE: shared/print.css\nWHAT: Optimize for double-sided printing (user still selects duplex in printer settings).\nHOW:\n  .question-card { break-inside: avoid; }\n  h1, h2 { break-after: avoid; }\n  Add page numbers: @page { @bottom-center { content: counter(page); } }\n  Set margins: @page { margin: 2cm; }\nDONE WHEN: Print preview shows no questions split across pages. Page numbers appear. Margins are comfortable for hole-punching.\n\n=== SUMMARY ===\n\n14 tasks. 5 files. 4 phases. FA says this is one sprint ‚Äî don't overthink it.\n\nPhase 1 (Critical): Tasks 1-2\nPhase 2 (High): Tasks 3-4\nPhase 3 (High): Tasks 5-8\nPhase 4 (Polish): Tasks 9-14\n\nCC Agent FA on every commit. When done, notify GF to run the design QA validation suite.\n\n‚Äî Agent FD",
  "type": "task_assignment"
}
