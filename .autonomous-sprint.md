# üèÄ MCM Autonomous Sprint ‚Äî Paste This Into Every Agent Window

**From Marcus (via FA). Read this carefully.**

---

## üî¥ CRASH RECOVERY PROTOCOL (added after server outage)

**What happened:** The AI backend went down at ~3:05am. All agents crashed with "Failed to get response from the AI model; retried 5 times." This is a backend outage ‚Äî not your fault.

**How to restart after a crash:**
```powershell
# Option 1: Use the watchdog (auto-retries on crash)
pwsh -File scripts\forge-watch.ps1 -Session "YOUR-SESSION-NAME" -Cwd "C:\Github\kai-algebra2-tests"

# Example for each agent:
pwsh -File scripts\forge-watch.ps1 -Session "mcm-app-agent" -Cwd "C:\Github\kai-algebra2-tests"
pwsh -File scripts\forge-watch.ps1 -Session "mcm-research-agent" -Cwd "C:\Github\kai-algebra2-tests"
pwsh -File scripts\forge-watch.ps1 -Session "fundamentals-agent" -Cwd "C:\Github\kai-algebra2-tests"
pwsh -File scripts\forge-watch.ps1 -Session "g-design-agent" -Cwd "C:\Github\kai-algebra2-tests"

# Option 2: Manual resume
agency copilot --resume YOUR-SESSION-NAME
```

**The watchdog script (`scripts/forge-watch.ps1`):**
- Wraps `agency copilot` in a retry loop
- If the process crashes (non-zero exit), waits with exponential backoff (30s ‚Üí 60s ‚Üí 120s ‚Üí 5min cap)
- Auto-resumes the session (keeps your context)
- Stops on clean exit (you typed /exit) or after 10 consecutive failures
- Logs all crashes to `~/.forge-watch.log`

**For Marcus:** When restarting agents after an outage, start them one at a time with 30-second gaps. If the backend is recovering and rate-limited, staggered restarts avoid re-triggering the limit.

**For agents reading this after a restart:** 
1. `git pull` first ‚Äî other agents may have committed while you were down
2. Check `.agent-status.md` ‚Äî see what happened while you were offline
3. Resume your task from where you left off
4. **Commit immediately** if you have uncommitted work ‚Äî don't lose progress to the next crash

---

## MISSION: Ship exam.html renderer + retake exam tonight

Kai's retake is Tue‚ÄìThu. Every hour without a working practice exam costs a practice cycle. This is the priority above all else.

## THE PLAN

```
Phase 1: Agent GA builds exam.html          ‚Üê THE CRITICAL PATH
Phase 2: Agent GF tests it                  ‚Üê Validates grading accuracy
Phase 3: Agent GR verifies math             ‚Üê Confirms all 15 answers grade correctly
Done: Kai has a working retake practice exam at exam.html?file=retake-practice-1
```

## YOUR ROLE (find your agent ID below)

---

### Agent GA (Application) ‚Äî YOU ARE THE CRITICAL PATH

**Task: Build `exam.html` per `docs/exam-renderer-spec.md`**

FA already answered your questions (commit `fee5843`, pull now):
- **LPM: Stub it.** `if (typeof MCM_LPM !== 'undefined') MCM_LPM.recordResults(...)`
- **test.html: Coexist.** Don't touch it.

**Build order:**
1. `git pull` ‚Äî get FA's answers and Agent R's retake JSON
2. Read `docs/exam-renderer-spec.md` (the full spec)
3. Read `data/retake-practice-1.json` (the test data ‚Äî 15 questions)
4. Build `exam.html` ‚Äî JSON-driven renderer that reads `?file=` URL param
5. Support all input types: dropdown, number, radio, text, plus_minus, canvas graph
6. Reuse: `shared/styles.css`, `shared/scripts.js` (gradeTest pattern, scorecard, SRS)
7. Canvas graphing: extract the pattern from `nonlinear_exam_mvp.html` ‚Äî drawGrid, click-to-plot, checkGraph, tooltip
8. After grading: show per-question feedback, scorecard (SAAS grade), per-standard breakdown, hint layers
9. Timer: use existing timer from shared/scripts.js, feed `time_minutes` from JSON
10. Test locally: open `exam.html?file=retake-practice-1` and answer all 15 questions
11. Commit and push when all 15 questions render and grade correctly

**If you get blocked:**
- Canvas code is complex ‚Üí look at `nonlinear_exam_mvp.html` lines with `drawGrid`, `redrawGraph`, `checkGraph`. Extract the pattern, don't copy the whole file.
- Graph questions are Q12 and Q13 only. If canvas is taking too long, ship the 13 non-graph questions first as a working commit, then add graph support in a second commit.
- KaTeX rendering: questions use `\( ... \)` LaTeX ‚Äî include the KaTeX CDN like other test files do.

**When done:** Commit with message `feat(GA): exam.html JSON renderer ‚Äî 15 questions grading`. Push. Then update your section in `.agent-status.md` saying "exam.html shipped, ready for GF testing."

---

### Agent GR (Research) ‚Äî MATH VERIFICATION

**Wait for GA to push exam.html, then:**
1. `git pull`
2. Open `exam.html?file=retake-practice-1` in browser
3. Answer all 15 questions with the correct answers from `data/retake-practice-1.json`
4. Verify every question grades correctly (15/15)
5. Verify per-standard breakdown matches the standards in the JSON
6. Verify hint ‚Üí answer ‚Üí solution_steps layers work on wrong answers
7. Check that graph questions (Q12, Q13) accept the `key_points` from the JSON

**If GA hasn't pushed yet:** Don't just wait. Do this instead:
- Review `data/retake-practice-1.json` one more time ‚Äî triple-check every answer, every tolerance, every solution step
- Write `data/retake-practice-2.json` ‚Äî a second practice exam for Kai (different numbers, same standards). Kai will need more than one practice run.
- Update your section in `.agent-status.md` with what you're doing

**When done:** Commit verification results to `.agent-status.md`. If you find ANY math bug, file it in the Bugs section of `.agent-status.md` as a blocker.

---

### Agent GF (Fundamentals) ‚Äî TEST VALIDATION

**Wait for GA to push exam.html, then:**
1. `git pull`
2. Test all 15 questions ‚Äî correct answers should score 15/15
3. Test edge cases: empty inputs, partial answers, wrong answers
4. Test plus_minus questions (Q1, Q3, Q5, Q6): entering answers in either order should score correctly
5. Test graph questions (Q12, Q13): plot the key_points, verify checkGraph accepts them
6. Test timer: verify countdown works from the JSON `time_minutes`
7. Test scorecard: verify SAAS grading (‚â•92=4, ‚â•82=3, ‚â•70=2, <70=1)
8. Test localStorage: verify `mcm_scores` saves after grading
9. Test URL param: `exam.html?file=retake-practice-1` loads, `exam.html` with no param shows error
10. Test SRS: verify `MCM_SRS.recordAnswer()` is called if available

**If GA hasn't pushed yet:** Don't just wait. Do this instead:
- Write Playwright test stubs for exam.html ‚Äî you know the spec, you can write the test structure now
- Review existing test suite ‚Äî run `npx playwright test` and report any regressions
- Validate `data/retake-practice-1.json` schema ‚Äî write a Node.js script that checks every question has required fields (id, number, standard, inputs, hint, solution_steps, feedback_correct, feedback_wrong)

**When done:** Commit test results or test scripts to the repo. Update `.agent-status.md`.

---

### Agent GP (Platform), GD (Design), GS (Security), GI (Data) ‚Äî SUPPORT

You are NOT on the critical path but you can help:

**GP:** Monitor `.agent-status.md` for blocked agents. If anyone posts a blocker, see if you can unblock them (resolve merge conflicts, clarify protocol questions). Keep the status board current.

**GD:** After GA pushes exam.html, do a quick visual QA ‚Äî does it match the Pistons design system? Arena Mode toggle? Mobile responsive at 375px? Post findings in `.agent-status.md`.

**GS:** After GA pushes, verify localStorage behavior ‚Äî does `mcm_scores` save correctly? Does import/export still work? No key collisions?

**GI:** Stand by. No tasks for you tonight.

---

## RULES FOR TONIGHT

1. **`git pull` before starting ANY work.** Every time. No exceptions.
2. **`git pull` before committing.** Check for conflicts.
3. **Don't wait for Marcus.** He's away for 2 hours. Make decisions yourself. If you're unsure, choose the simpler option and document why in your commit message.
4. **If you're blocked, do your fallback work** (listed above for each agent). Don't sit idle.
5. **Check `.agent-status.md` every 15-20 minutes** (after each major task). Look for messages from other agents, blockers, or requests.
6. **Post your status** when you start, when you finish a major step, and if you hit a blocker. Your section in `.agent-status.md` is your voice.
7. **Don't modify files you don't own.** GA owns exam.html and shared/. GR owns data/. GF owns tests/. Check the ownership table in `.agents.md`.
8. **Commit often.** Small commits > one big commit. Push after each logical unit of work.
9. **If exam.html is taking too long**, ship what works first. 13 non-graph questions working > 15 questions half-broken.

## DEFINITION OF DONE

‚úÖ `exam.html?file=retake-practice-1` renders 15 questions in the browser
‚úÖ Answering correctly scores 15/15 with SAAS grade
‚úÖ Wrong answers show hint ‚Üí answer ‚Üí solution_steps
‚úÖ Per-standard breakdown appears in scorecard
‚úÖ Timer counts down from 60 minutes
‚úÖ Scores save to localStorage (`mcm_scores`)
‚úÖ Graph questions (Q12, Q13) have interactive canvas with click-to-plot
‚úÖ Plus/minus questions accept either ordering
‚úÖ All code committed and pushed to origin/master

**If graph questions are too complex to finish tonight, the minimum viable delivery is:**
‚úÖ 13 non-graph questions rendering and grading correctly
‚úÖ Q12/Q13 show as "graph question ‚Äî interactive grading coming soon"
This still gives Kai 13 practice questions to work with tomorrow.

## TIMELINE

```
Now ‚Üí +45 min:  GA builds exam.html (non-graph questions first)
+45 min ‚Üí +60:  GA adds graph support (or ships without and iterates)
+60 ‚Üí +75 min:  GA pushes. GR + GF pull and start testing.
+75 ‚Üí +90 min:  GR verifies math. GF tests edge cases.
+90 ‚Üí +120:     Fix any bugs found. Final push.
Marcus returns:  Everything is green.
```

## ‚ö†Ô∏è KEEP-ALIVE PROTOCOL ‚Äî NO IDLE AGENTS

**This is critical. Marcus cannot unblock you. You must keep yourself busy.**

### Every agent, every 15 minutes:
1. `git pull` ‚Äî check for new commits from other agents
2. Read `.agent-status.md` ‚Äî look for messages, blockers, requests directed at you
3. Read `.autonomous-sprint.md` ‚Äî re-read your section if you're unsure what to do next
4. Post a 1-line status update in your section of `.agent-status.md`: what you just finished, what you're doing next
5. Commit and push your status update so other agents can see it

### If you finish your primary task:
- **GA after exam.html ships:** Write `data/retake-practice-2.json` renderer support verification, fix any bugs GR/GF find, add Arena Mode toggle to exam.html
- **GR after math verification:** Write `data/retake-practice-2.json` (second practice exam, new numbers, same standards). Then write `data/retake-practice-3.json`. Kai needs volume.
- **GF after testing:** Write Playwright tests for exam.html. Automate the 15-question grading check. Add exam.html to the existing test suite.
- **GP:** Audit the dashboard ‚Äî does `index.html` link to exam.html? Should it? Draft the link/navigation update for GA.
- **GD:** Visual QA exam.html against `.design-system.md`. File CSS issues in `.agent-status.md`.

### If you're waiting for GA to push:
**Do NOT post "waiting for GA" and stop.** That wastes Kai's practice time. Do your fallback work:
- **GR:** Write retake-practice-2.json NOW. Don't wait.
- **GF:** Write Playwright test stubs NOW. Write JSON schema validator NOW. Run existing test suite and report results.
- **GP:** Review `.agent-status.md` formatting, update README if needed.

### If you hit a real blocker (merge conflict, crash, unclear spec):
1. Post the blocker in `.agent-status.md` with full detail (error message, what you tried)
2. Try to work around it yourself ‚Äî choose the simpler path
3. Move to your fallback task while the blocker is unresolved
4. **Do not stop working.** There is always something productive to do.
5. **Do NOT wait for Marcus or FA to unblock you. They are not available.** Solve it yourself or route around it.

### Decision Authority (while Marcus is away)
You have authority to make these calls yourself tonight. Do NOT wait for approval:
- **Spec ambiguity?** Choose the simpler interpretation. Document your choice in the commit message.
- **Merge conflict?** Resolve it. You can read both versions and pick the right merge.
- **Missing dependency?** Stub it or skip it. Ship what works.
- **Bug in another agent's code?** Fix it yourself and note it in `.agent-status.md`. Don't file a blocker and wait.
- **Unsure about design?** Match what `nonlinear_exam_mvp.html` already does. That's the reference implementation.

### üî¥ THE GOLDEN RULE: If you have nothing to do, you haven't looked hard enough.
Read `.autonomous-sprint.md` again. Read `.agent-status.md` again. There is ALWAYS a fallback task. Kai's retake is this week. Every idle minute is a minute he can't practice.

---

**This is the dispatch from FA. I've already cleared Agent A's questions (stub LPM, coexist with test.html). The spec is solid, the data is ready, the path is clear. Ship it.**
